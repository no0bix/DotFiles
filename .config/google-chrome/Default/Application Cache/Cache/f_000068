NO.prototype.bda=ea(213,function(a){I(this,2,a)});NO.prototype.tH=ea(212,function(){return H(this,2)});Ar.prototype.T9=ea(76,function(){return Tf(this,3)});jH.prototype.T9=ea(75,function(){return Tf(this,5)});Ar.prototype.u7=ea(74,function(){return H(this,3)});jH.prototype.u7=ea(73,function(){return H(this,5)});Ar.prototype.X9=ea(72,function(){return Tf(this,2)});jH.prototype.X9=ea(71,function(){return Tf(this,4)});Ar.prototype.L7=ea(70,function(){return H(this,2)});
jH.prototype.L7=ea(69,function(){return H(this,4)});function N9e(a,b){Ei(a,11,b)}function O9e(a,b,c){return"r"==c?a.vZ(b):a.eM(b)}function P9e(a,b){return(a=IY(a,b))?a.rect:null}function Q9e(a,b){a.D=b}function R9e(a){wi(this,a,0,-1,null,null)}x(R9e,vi);function S9e(a){wi(this,a,0,-1,null,null)}x(S9e,vi);var T9e=/['()]/g;function U9e(a){return"%"+a.charCodeAt(0).toString(16)}function V9e(a){a=We(String(a));T9e.lastIndex=0;return T9e.test(a)?a.replace(T9e,U9e):a}
function W9e(a,b){this.D=a;this.C=b}function X9e(a){return a.Pl()+df(a.C)}function Y9e(a,b,c,d,e,f,h,k,l){Rm.call(this,a);this.D=b;this.F=c;this.C=d;this.H=e;this.L=f;this.ea=h;this.va=k;this.Ha=l||null}x(Y9e,Rm);
function Z9e(a,b,c,d,e){cB.call(this);this.Ta=c;this.Ya=d.C;this.Sa=d;this.Ub=e;this.Xa=null;this.Cb=d.Da;this.setTitle("Find and replace");Sz(this,!1);c=this.Fb();d=Ju(c);Q(this.Ma(),"waffle-find-replace-dialog");this.C=d.Aa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ha=d.Aa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new pR(null);this.qa(this.F);this.tc=b;this.R=new HV(this.Ta,v(this.T1b,this),!1,"",!0);this.qa(this.R);this.ea=null;this.O=(this.va=
B(A(),"docs-egmd"))?new lT(!1,mT.getInstance(),this.oa()):new nT;this.qa(this.O);this.V=this.va?new lT(!1,mT.getInstance(),this.oa()):new nT;this.qa(this.V);this.L=this.va?new lT(!1,mT.getInstance(),this.oa()):new nT;this.qa(this.L);this.J=this.va?new lT(!1,mT.getInstance(),this.oa()):new nT;this.qa(this.J);this.Vb=this.cb=this.yb=this.Jb=!1;this.bb=d.Aa("SPAN","waffle-find-replace-dialog-display-message");aUd(this.bb);this.kc=new iB(this.C);this.qa(this.kc);d.Aa("LABEL",{"for":"waffle-find-replace-find-scope-select"},
"Search");a=d.Aa("LABEL",{"for":"find-replace-case","class":"waffle-findandreplacedialog-checkbox-label"},"Match case");b=d.Aa("LABEL",{"for":"find-replace-cell","class":"waffle-findandreplacedialog-checkbox-label"},"Match entire cell contents");e=d.Aa("LABEL",{"class":"waffle-findandreplacedialog-checkbox-label"},"Also search within formulae");var f=d.Aa("LABEL",{"for":"find-replace-regex","class":"waffle-findandreplacedialog-checkbox-label"},"Search using regular expressions "),h=d.Aa("SPAN",null,
d.Aa("A",{target:"_blank",href:"https://support.google.com/docs?p=spreadsheets_find_replace",style:this.va?"vertical-align: bottom;":"vertical-align: middle;"},"Help"));this.getHandler().listen(h,["keydown","keypress"],function(t){13==t.keyCode&&t.stopPropagation()});var k=Sw(this,"findLabel"),l=Sw(this,"replaceLabel"),m=Sw(this,"findScopeLabel"),p=d.Aa("DIV","goog-inline-block"),q=d.Aa("DIV","waffle-find-replace-selection-input goog-inline-block");h=d.Aa("TABLE",null,d.Aa("TBODY",null,d.Aa("TR",
null,d.Aa("TD","waffle-find-replace-dialog-label",d.Aa("LABEL",{id:k},"Find")),d.Aa("TD",null,this.C)),d.Aa("TR",null,d.Aa("TD","waffle-find-replace-dialog-label",d.Aa("LABEL",{id:l},"Replace with")),d.Aa("TD",null,this.Ha)),d.Aa("TR",null,d.Aa("TD",null,d.Aa("LABEL",{id:m},"Search")),d.Aa("TD",null,p,q)),d.Aa("TR",null,d.Aa("TD",null,""),d.Aa("TD",null,d.Aa("DIV","waffle-find-replace-option",a),d.Aa("DIV","waffle-find-replace-option",b),d.Aa("DIV","waffle-find-replace-option",f,h),d.Aa("DIV","waffle-find-replace-option",
e))),d.Aa("TR",null,d.Aa("TD",{colspan:"2"},this.bb))));this.F.render(p);Q(this.F.getElement(),"waffle-find-replace-find-scope-select");this.R.render(q);Rw(this.O,a);kT(this.O,a);Q(this.O.getElement(),"waffle-findandreplacedialog-checkbox");this.O.getElement().id="find-replace-case";Rw(this.V,b);kT(this.V,b);Q(this.V.getElement(),"waffle-findandreplacedialog-checkbox");this.V.getElement().id="find-replace-cell";Rw(this.L,f);kT(this.L,f);this.L.getElement().id="find-replace-regex";Q(this.L.getElement(),
"waffle-findandreplacedialog-checkbox");kT(this.J,e);Rw(this.J,e);Q(this.J.getElement(),"waffle-findandreplacedialog-checkbox");ex(this.C,"labelledby",k);ex(this.Ha,"labelledby",l);ex(this.F.Ma(),"labelledby",m);d.appendChild(c,h);c=new Tz;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Wz(this,c);B(A(),"docs-egmd")?dA(this,"done"):dA(this,"");this.getHandler().listen(this,"dialogselect",this.U1b).listen(this.kc,"input",this.Nna).listen(this.L,
"change",this.hxb).listen(this.F,"change",this.anb).listen(this.R,"change",this.V1b).listen(this.J,"change",this.kxb);c=new jB;c.Va(this.C);this.qa(c);c=new jB;c.Va(this.Ha);this.qa(c);$9e(this);c=new Fz(this.getElement());this.qa(c);this.getHandler().listen(c,"focusin",this.EVa).listen(this.getElement(),"mousedown",this.EVa)}x(Z9e,cB);
function $9e(a){var b=cL(a.Ta),c=null,d=null;b&&(c=Yvc(b),d=tM(a.Ya,c.C).Yd());a.J.gc(a.Cb);var e=new Yx("All sheets",2),f=new Yx("This sheet",1),h=new Yx("Specific range",0);a.F.Qc(e);a.F.Qc(f);a.F.Qc(h);f=c?CM(a.Ya,c.C):null;f=(f=c&&f?QJ(f,c.rect.Ac(),c.rect.xc()):null)?f.Jh():1;c&&c.rect.Jh()>f?By(a.F,h):By(a.F,e);b&&a.R.setValue(VN(c.rect,d))}function a$e(a){var b=a.F.zf().Pa(),c=sM(a.Ta.D);return 0==b?TN(a.R.getValue(),a.Ya,!1,!0):1!=b||null===c?null:new fm(c,new Ol(0,0,1,1))}r=Z9e.prototype;
r.EVa=function(a){a.target==this.getElement()?this.focus():this.Ub.Qb(2)};r.V1b=function(){b$e(this)};r.kxb=function(){var a=this.J.isChecked();Crd(this.Sa,a)};r.anb=function(){b$e(this)};r.hxb=function(){this.L.isChecked()&&this.O.gc(!0);this.Nna()};
r.U1b=function(a){if("findNext"==a.key)a.preventDefault(),this.Jb&&(A5(this,null),c$e(this,"findnext"));else if("replace"==a.key)a.preventDefault(),this.yb&&(A5(this,null),c$e(this,"replace"));else if("replaceAll"==a.key&&(a.preventDefault(),this.Vb)){a=v(function(){A5(this,null);c$e(this,"replaceall")},this);var b=this.F.zf().Pa();1<this.Ya.D.length&&2==b&&!this.cb?(sPd("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.cb=!0):a()}};
r.Nna=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Xz(this.D,"findNext").disabled=!a;this.Jb=a;d$e(this,a);this.yb&&!a&&e$e(this,!1);ux(this.C,"waffle-input-error",b)};r.T1b=function(a,b,c){this.Xa=a.Os();this.tc.rf(this,a,b,c,!1,!0)};
function b$e(a){var b=0==a.F.zf().Pa();a.R.setVisible(b);F(a.ea);a.ea=null;var c=a$e(a),d=cL(a.Ta);b&&d&&c&&(a.ea=oQ(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.ea.setVisible(!0),a.qa(a.ea))}function c$e(a,b){if(!a.isDisposed())if(0==a.F.zf().Pa()&&null==a$e(a))ux(a.R.F,"waffle-range-selection-error",!0),A5(a,"Invalid range");else{var c=a.F.zf().Pa();a.dispatchEvent(new Y9e(b,a.C.value,a.Ha.value,c,a.O.isChecked(),a.V.isChecked(),a.L.isChecked(),a.J.isChecked(),a$e(a)))}}
r.setVisible=function(a){var b=this.Sa.Id();d$e(this,!b);e$e(this,!b);this.Ha.disabled=b;Z9e.Ia.setVisible.call(this,a);a&&this.Xa&&(this.Xa.focus(),this.Xa=null)};r.nYb=function(a){this.C.value=a};r.eSa=function(){this.C.select()};r.focus=function(){this.Db()&&this.isVisible()&&(this.C.focus(),this.Ub.Qb(2),NA(this.C,this.C.value.length),this.Nna())};function e$e(a,b,c){b=b&&!a.Sa.Id()&&0==!a.C.value.length;a.yb=b;a=Xz(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function d$e(a,b){b=b&&!a.Sa.Id()&&0==!a.C.value.length;a.Vb=b;Xz(a.D,"replaceAll").disabled=!b}function A5(a,b){var c=Ju(a.Fb());a=a.bb;b?(0<dv(a).length&&c.appendChild(a,c.Aa("BR")),c.appendChild(a,c.Aa("B",null,tv(c,b)))):c.ld(a)}r.Ja=function(){Z9e.Ia.Ja.call(this);this.cb=!1;Crd(this.Sa,this.Cb)};
function f$e(a,b,c){b=c||b;var d=a.title;c=a.Is;var e=a.RXb;a=a.yd;a='<div class="office-editing-feedback '+(a?" "+W(a):"")+'"><div class="office-editing-feedback-title">'+U(d)+'</div><span class="office-editing-feedback-title-separator">&#8208;</span><a href="'+W(dz(e))+'" target="_blank" rel="noreferrer">';a+="Send feedback</a>";c&&(a+=U(zz({yd:"office-editing-feedback-close-button",content:az(""+U(kB({icon:$y("docs-icon-img docs-icon-close-thin")},b))),style:4,title:$y("Close")},b)));return V(a+
"</div>")}function g$e(a,b,c,d){P.call(this,c);this.J=b;a:switch(a){case "editor-header":case "warning-dialogs":c="Office Native Editing";break a;default:c=""}this.D=c;a:switch(a){case "editor-header":a="office-editing-feedback-editor-header";break a;case "warning-dialogs":a="office-editing-feedback-warning-dialogs";break a;default:a=""}this.H=a;(this.C=b?new Az:null)&&this.Fa(this.C);this.F=d||(B(A(),"docs-idu")?Ic(A(),"docs-sddfu"):Ic(A(),"docs-sdttfu"))}u(g$e,P);
g$e.prototype.Aa=function(){var a=R(f$e,{title:this.D,Is:this.J,RXb:this.F,yd:this.H},void 0,this.oa());this.sb(a);this.C&&this.C.Va(this.Ea("office-editing-feedback-close-button"))};g$e.prototype.Ga=function(){var a=this;P.prototype.Ga.call(this);this.C&&this.getHandler().listen(this.C,"action",function(){return N(a.Ma(),!1)})};function h$e(a){var b=a.title;return V('<div class="docs-native-editing-warning-title-text docs-material-gm-dialog-title-text" id="'+W(a.id)+'">'+U(b)+"</div>")}
function B5(a,b,c,d){ZT.call(this,void 0,a,d,!0);this.Ya=c;this.ea=zj("warning-header-text");this.J=null;if(b.L){b=B(A(),"docs-idu");c=B(A(),"docs-sdsnfl");d=Ic(A(),"docs-sddfu");var e=Ic(A(),"docs-sdttfu");(this.J=!b&&!c||zd(d)||zd(e)?null:new g$e("warning-dialogs",!1,a,b?d:e))&&this.Fa(this.J)}Vz(this,!1);this.fz(!1);this.Ri=!0}u(B5,ZT);r=B5.prototype;r.ux=n("alertdialog");
r.Aa=function(){ZT.prototype.Aa.call(this);Oy(Nz(this),h$e,{title:this.Ya,id:this.ea});this.BRa();var a=this.Ma();this.J&&this.J.render(a);var b=this.p7();this.C.setContent(b);this.C.Ef(this.p7());if(b=this.F?this.F.bh():void 0){if(!this.F)throw Error("Attempted to set cancel button content when the cancel button doesnt exist");this.F.setContent(b);this.F.Ef(b)}Q(a,this.zMa())};r.Ga=function(){ZT.prototype.Ga.call(this);ex(this.Ma(),"labelledby",this.ea)};r.qg=n(!1);r.p7=function(){return this.C.bh()};
function i$e(a){var b=a.yh,c=a.Cm,d=V;a=a.XWb;a=V('<div class="docs-unsupportedofficefeatureswarning-content-restorefiletext" id="'+W(c.Kwa)+'">'+U(a)+"</div>");c='<div class="docs-unsupportedofficefeatureswarning-content-features-list" id="'+W(c.dwa)+'">';for(var e=b.length,f=0;f<e;f++)c+=V('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+U({feature:$y(""+b[f])}.feature)+"</div>");b=V(c+"</div>");return d(a+b)}
function j$e(a){a=a.At;a='<a class="'+W("docs-unsupportedofficefeatureswarning-learn-more")+'" target="_blank" rel="noreferrer" href="'+W(dz(a))+'">';return V(a+"Learn more</a>")}var k$e={dwa:"features-list",Kwa:"restore-file-text"};function C5(a,b,c,d,e){B5.call(this,d,a,c,e);this.Ta=b;this.L=Id(k$e,function(f){return zj(f)});this.V=Ic(A(),"docs-deuoflmu")}u(C5,B5);C5.prototype.Ga=function(){B5.prototype.Ga.call(this);ex(this.Ma(),"describedby",[this.L.Kwa,this.L.dwa])};
C5.prototype.BRa=function(){Oy(this.Fb(),i$e,{yh:this.Ta,Cm:this.L,XWb:this.O()});if(this.V){var a=R(j$e,{At:this.V});Pz(this).prepend(a)}};C5.prototype.zMa=n("docs-unsupportedofficefeatureswarning");function l$e(a,b,c,d,e,f){for(var h=new nJ,k=ka(b),l=k.next();!l.done;l=k.next())h.add(Ivd(l.value));C5.call(this,a,h.Jd(),c,d);this.R=!1;this.Sa=e;this.Ha=f;this.va=b}u(l$e,C5);l$e.prototype.p7=n("Continue editing");l$e.prototype.O=n("The original file can be restored from version history");
l$e.prototype.Ga=function(){var a=this;C5.prototype.Ga.call(this);this.getHandler().listen(this,"nd",function(){a.R=!0;a.Sa.Gb(c4c(a.va));return!0})};l$e.prototype.Vl=function(){C5.prototype.Vl.call(this);this.R||this.Ha.Gb(c4c(this.va))};function m$e(a,b,c){cB.call(this,void 0,void 0,c);this.Ri=!0;this.setTitle("Alt Text");dA(this,"ok");b=b||"";a='<div class="alt-text-dialog-content"><div class="alt-text-dialog-intro">Alt text is accessed by screen readers for people who might have trouble seeing your content.</div><table cellspacing="0" cellpadding="0" role="presentation"><tr class="alt-text-dialog-title-container"><td><label for="alt-text-dialog-title">Title'+('</label></td><td><input id="alt-text-dialog-title" class="jfk-textinput" type="text" maxlength="5000" value="'+
W(a||"")+'"></td></tr><tr class="alt-text-dialog-description-container"><td><label for="alt-text-dialog-description">');a=a+"Description"+('</label></td><td><textarea id="alt-text-dialog-description" class="jfk-textinput" maxlength="5000">'+u2a(b)+"</textarea></td></tr></table></div>");a=V(a);Iz(this,My(a));this.ye(Sw(this,"alt-text"))}u(m$e,cB);m$e.prototype.F=function(){return n$e(this,"alt-text-dialog-title")};m$e.prototype.C=function(){return n$e(this,"alt-text-dialog-description")};
function n$e(a,b){return(a=a.oa().getElement(b))&&null!=a.value?a.value:null};function o$e(a){var b=a.r3b;return V('<div class="docs-binaryupsavewarning-content-text" id="'+W(a.id)+'">'+U(b)+"</div>")};function p$e(a,b,c,d,e,f){B5.call(this,b,a,e);this.O=!1;this.V=c;this.R=d;this.va=f;this.L=zj("warning-explanation")}u(p$e,B5);r=p$e.prototype;r.zMa=n("docs-binaryupsavewarning");r.BRa=function(){Oy(this.Fb(),o$e,{id:this.L,r3b:this.va})};r.Ga=function(){var a=this;B5.prototype.Ga.call(this);this.getHandler().listen(this,"nd",function(){a.O=!0;a.V.Gb();return!0});ex(this.Ma(),"describedby",this.L)};r.p7=n("Continue");r.Vl=function(){B5.prototype.Vl.call(this);this.O||this.R.Gb()};function q$e(a){a=a.link;return V('<input type="text" class="'+W("docs-copy-link")+'" value="'+W(a)+'" readonly="readonly">')};function r$e(a,b,c,d){cB.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.ea="";this.F=b||null;this.va=c||new C7c(a);this.V=null!=d?d:null;a=new Tz;Yz(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.va.C()&&Yz(a,{key:"copy-link",caption:"Copy link"});Wz(this,a);this.R=new ym;this.qa(this.R)}u(r$e,cB);r=r$e.prototype;
r.Aa=function(){cB.prototype.Aa.call(this);Q(Qz(this),"copy-link-dialog");Q(Xz(this.D,"done"),"copy-link-done-button");this.C=R(q$e,{link:this.ea},void 0,this.oa());ex(this.C,"label","Link to this comment");this.Fb().appendChild(this.C);this.L=Xz(this.D,"copy-link");null!==this.V&&(rw(this.kq(),"z-index",this.V),rw(Qz(this),"z-index",this.V+1));if(this.L){var a=Uu("DIV");Q(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Nz(this));this.O=new jA(a);this.J=lA("Link copied to clipboard.",
"info",!1,4E3);var b=tw(Qz(this),"zIndex");rw(a,"z-index",b+1)}};r.Fm=function(){var a=this;cB.prototype.Fm.call(this);this.F&&Cm(this.R,this.F.C(),function(b){b.C&&a.J&&a.O&&(a.J.isVisible()||a.O.postMessage(a.J),a.C.focus(),a.C.select())});this.C.focus();this.C.select()};r.Vl=function(){cB.prototype.Vl.call(this);this.F&&ova(this.R,this.F.C())};r.Ga=function(){cB.prototype.Ga.call(this);this.getHandler().listen(this.C,"click",this.NXb);this.L&&this.getHandler().listen(this.L,"click",this.bjb)};
r.wYb=function(a){this.ea=a;this.C&&(this.C.value=a)};r.NXb=function(a){a.target.focus();a.target.select()};r.bjb=function(a){a.stopPropagation();this.F&&this.va.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.F(this.C.value))};r.Ja=function(){cB.prototype.Ja.call(this);F(this.J);delete this.J;delete this.L;delete this.C};function D5(a){P.call(this);this.J=new P;this.qa(this.J);this.D=new JA("");this.qa(this.D);this.O=new Az("");this.qa(this.O);this.V=a;this.Qd=null}x(D5,P);r=D5.prototype;
r.Ga=function(){D5.Ia.Ga.call(this);var a=Uw(this,"nfd-icwr");this.J.Va(a);this.Fa(this.J);if(a=Uw(this,"nfd-i"))this.D.Va(a),this.D.Rd(this.J),sx(this.D.getElement(),"jfk-textinput"),a=new jB,a.Va(this.D.getElement()),this.qa(a),this.R=a=new iB(this.D.getElement()),this.qa(a),this.Qd=a=new jx(this.D.getElement()),this.qa(a),a=new Fz(this.D.getElement()),this.getHandler().listen(a,"focusout",La(this.HVa,!1)).listen(a,"focusin",La(this.HVa,!0)).listen(this.R,"input",this.a2b);a=Uw(this,"nfd-a");this.O.Va(a);
this.Fa(this.O)};r.Hv=g("Qd");r.getValue=function(){return this.D.getValue()};r.a2b=function(){var a=this.Pa(),b=this.getValue();I(a.aJ,2,b);this.IVa()};r.IVa=ee;r.HVa=function(a){ux(this.J.getElement(),"nfd-input-focus",a)};r.lP=function(a){this.Pb(a.clone());this.D.setValue(a.$A());try{this.D.getElement().focus()}catch(b){}};r.wCa=function(){this.D.getElement().focus()};function s$e(a,b){a=a.J.getElement();ux(a,"nfd-invalid",b)};function t$e(a){var b=a.BWb;return V("<li class='nfd-format-pill'><div class='nfd-format-display'>"+U(a.N$a)+"</div><div class='nfd-format-sample'>"+U(b)+"</div></li>")};function u$e(a,b,c){P.call(this);this.Pb(a);this.D=b;this.C=c}u(u$e,P);r=u$e.prototype;r.Aa=function(){var a=this.Pa(),b=this.C?hga(a.$A(),30):a.$A();a=this.C?prd(a,this.D):"";b=R(t$e,{N$a:b,BWb:a});this.sb(b)};r.Ga=function(){P.prototype.Ga.call(this);kv(this.getElement(),!0);var a=new jx(this.getElement());this.qa(a);this.getHandler().listen(a,"key",this.QLb).listen(this.getElement(),"mousedown",this.PLb).listen(this.getElement(),"dblclick",this.Ukb)};
r.QLb=function(a){function b(c,d){for(;d=c(d);)if(Iw(d)){d.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(fv,this.getElement());break;case 38:b(SXa,this.getElement())}};r.PLb=function(a){a.preventDefault();this.dispatchEvent("change")};r.Ukb=function(){this.dispatchEvent("action")};function v$e(a,b,c){P.call(this);this.C=b;this.D=c;w$e(this,a)}u(v$e,P);v$e.prototype.Aa=function(){var a=this.oa().Aa("UL","nfd-pill-container");this.sb(a)};function w$e(a,b){Nc(b,function(c){a.Fa(new u$e(c,a.C,a.D),!0)})}v$e.prototype.filter=function(a){a=a.toLowerCase();this.Ve(function(b){var c=zd(df(a)),d=b.Pa().$A().toLowerCase();c=c||Bd(d,a);N(b.getElement(),c)})};function E5(a){cB.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Jha();this.Fa(this.input,!0);this.J=new P;this.Fa(this.J,!0);a=this.S7();kd(a,void 0,X9e);this.C=new v$e(a,this.wZ(),this.xTa());this.J.Fa(this.C,!0);Wz(this,null);this.Ri=!0}x(E5,cB);r=E5.prototype;r.oNa=ee;r.xTa=ce;r.isEmpty=function(){return zd(this.input.getValue())};r.tf=function(){return this.input.Pa().tf()};r.Aa=function(){E5.Ia.Aa.call(this);var a=Uu("DIV","dialog-separator");av(a,Nz(this))};
r.Ga=function(){E5.Ia.Ga.call(this);Q(this.J.getElement(),"nfd-dialog-content");this.getHandler().listen(this.C,"change",this.onb).listen(this.C,"action",this.Wpa).listen(this.input.O,"action",this.Wpa).listen(this.input,"afterhide",this.yfb);this.input.R&&this.getHandler().listen(this.input.R,"input",this.ILb);var a=this.input.Hv();a&&this.getHandler().listen(a,"key",this.JLb);a=this.S7()[0];this.input.lP(a)};r.yfb=function(a){a.stopPropagation()};
r.onb=function(a){this.input.lP(a.target.Pa());s$e(this.input,!1)};r.ILb=function(){this.C.filter(this.input.getValue());s$e(this.input,!this.input.Pa().tf())};r.JLb=function(a){13==a.keyCode&&this.Wpa()};r.Wpa=function(){this.tf()&&!this.isEmpty()?(Efb.Gb(new IW(this.t1(),void 0,this.oNa())),this.setVisible(!1)):(s$e(this.input,!0),this.input.wCa())};function F5(a,b,c,d,e){Yx.call(this,b,c,d,e);this.C=a}u(F5,Yx);F5.prototype.bh=function(){var a=Yx.prototype.bh.call(this),b=this.getParent();return b&&b instanceof Hx&&!b.isVisible()?this.C(a,this.Pa()):a};function x$e(a){a=a||{};var b=a.id,c=a.name,d=a.yd,e=a.XTb,f=a.X0b,h=a.maxLength,k=a.value,l=a.dir,m=a.type,p=a.pattern;a=a.attributes;return V('<input class="'+W("jfk-textinput")+(d?" "+W(d):"")+'"'+(b?' id="'+W(b)+'"':"")+(h?' maxlength="'+W(h)+'"':"")+(Zy(e)&&Zy(f)?' label="'+W(e)+'"':"")+(c?' name="'+W(c)+'"':"")+(e?' placeholder="'+W(e)+'"':"")+' type="'+W(null!=m?m:"text")+'"'+(p?' pattern="'+W(p)+'"':"")+(k?' value="'+W(k)+'"':"")+(l?' dir="'+W(l)+'"':"")+(a?" "+B2a(a):"")+">")};function y$e(a,b,c){b=c||b;return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.e0)+"'>"+z$e(a)+"</div>"+A$e(a,b)+"</div>")}function B$e(a,b,c){b=c||b;return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.e0)+"'></div>"+A$e(a,b)+"</div>")}
function C$e(a,b,c){b=c||b;c=a.BDb;return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.e0)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+z$e(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+W(c)+"'></div></div></div></div>"+A$e(a,b)+"</div>")}
function D$e(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+E$e({label:""});a+=E$e({label:az("Negative:")});a+=E$e({label:az("Zero:")});a+=E$e({label:az("Text:")});return V(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function E$e(a){return V("<tr><td class='nfd-sample-label'>"+U(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function A$e(a,b){a=""+U(zz({id:a.WK,style:2,yd:"nfd-apply",content:$y("Apply")},b));return V(a)}function z$e(a){return V(U(x$e({id:a.wKa,XTb:a.xKa,X0b:!0})))};function F$e(a){D5.call(this,a);this.F=new P;this.C=new pR("");this.C.$c("nfd-currency-other-formats")}u(F$e,D5);r=F$e.prototype;r.Aa=function(){var a=R(C$e,{e0:Sw(this,"nfd-icwr"),wKa:Sw(this,"nfd-i"),xKa:this.V,BDb:Sw(this,"nfd-ic"),WK:Sw(this,"nfd-a")});this.sb(a)};
r.Ga=function(){D5.prototype.Ga.call(this);var a=Uw(this,"nfd-ic");this.F.Va(a);this.F.Rd(this.J);this.F.Fa(this.C,!0);this.getHandler().listen(this.C,"aftershow",this.KLb).listen(this.C,"action",this.qHa).listen(this.R,"input",La(this.lVa,null))};r.lP=function(a){D5.prototype.lP.call(this,a);a.C&&this.D.setValue(EA[a.C][1]);this.lVa(a)};
r.lVa=function(a){a=a?a.C:void 0;var b=this.C;b.Ze(null);if(a){var c=this.Pa(),d=c.C;G$e(this,c);c=pxd(d,EA[d][2]);c=new IW(H$e(c),oxd[d],d);G$e(this,c);c=pxd(d,d+" "+EA[d][1]);d=new IW(H$e(c),oxd[d],d);G$e(this,d)}else this.Pa().C=null;var e="[$"+this.getValue()+"]";d=a?oxd[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new IW(H$e(c[e]),d,a);G$e(this,f)}b.ef(0);this.qHa();Q(b.Tb().getElement(),"number-format-menu")};function G$e(a,b){var c=new F5(function(d){return hga(d,25)},prd(b,1E3),b);a.qa(c);a.qa(b);c.Eo(!0);a=a.C;for(b=0;b<a.oi();b++)if(a.Jf(b).bh()==c.bh())return;a.Qc(c)}r.qHa=function(){for(var a=this.C,b=0;b<a.oi();b++)a.Jf(b).gc(!1);a.HP()};r.KLb=function(){this.C.zf().gc(!0)};function H$e(a){var b=new ag;I(b,2,a);b.setType(4);return b};function I$e(a){E5.call(this,a);this.setTitle("Custom currencies")}u(I$e,E5);r=I$e.prototype;r.wZ=n(1000.12);r.Jha=function(){return new F$e("Custom currency")};r.S7=function(){var a=this;Std();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=oxd[e]:Q9e(d,rxd(d.Pl()))}var f=[];Gd(EA,function(k,l){k=qxd(l);a.qa(k);f.push(k)});var h=NSd();od(f,function(k,l){return h(k.$A(),l.$A())});return b.concat(f)};
r.t1=function(){var a=new ag;a.setType(4);I(a,3,1);var b=this.input.C.zf().getValue().Pl();I(a,2,b);return a};r.oNa=function(){return this.input.Pa().C};function J$e(a){P.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(J$e,P);J$e.prototype.Aa=function(){var a=R(D$e);this.F=Qu("nfd-sample-label",a);this.D=Pu("nfd-rendered-sample",a);this.sb(a)};function K$e(a,b){D5.call(this,a);this.C=new J$e(b);this.Pb(new IW(""))}u(K$e,D5);K$e.prototype.Aa=function(){var a=R(y$e,{wKa:Sw(this,"nfd-i"),xKa:this.V,e0:Sw(this,"nfd-icwr"),WK:Sw(this,"nfd-a")});this.sb(a)};K$e.prototype.Ga=function(){D5.prototype.Ga.call(this);this.Fa(this.C,!0);L$e(this)};K$e.prototype.IVa=function(){L$e(this)};K$e.prototype.lP=function(a){D5.prototype.lP.call(this,a);L$e(this)};
function L$e(a){var b=a.Pa();if(b){var c=a.C;a=b.Pl().split(";").length-1;jv(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=prd(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Pl()),k=d<=a;N(UXa(e),k);jv(e,f);rw(e,"color",h||"")}d=b.tf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Pl()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Pl());c=c.D[3];N(UXa(c),3<=a);jv(c,d);rw(c,"color",b||"")}};function M$e(a){E5.call(this,a);this.setTitle("Custom number formats")}u(M$e,E5);M$e.prototype.wZ=n(1234.56);M$e.prototype.Jha=function(){return new K$e("Custom number format",1234.56)};
M$e.prototype.S7=function(){var a=this.F;a.push(new IW("0"));a.push(new IW("0.00"));a.push(new IW("#,##0"));a.push(new IW("#,##0.00"));a.push(new IW("#,##0_);(#,##0)"));a.push(new IW("#,##0_);[Red](#,##0)"));a.push(new IW("#,##0.00_);(#,##0.00)"));a.push(new IW("#,##0.00_);[Red](#,##0.00)"));a.push(new IW("$#,##0_);($#,##0)"));a.push(new IW("$#,##0_);[Red]($#,##0)"));a.push(new IW("$#,##0.00_);($#,##0.00)"));a.push(new IW("$#,##0.00_);[Red]($#,##0.00)"));a.push(new IW("@"));a.push(new IW("0%"));a.push(new IW("0.00%"));
a.push(new IW("0.00E+00"));a.push(new IW("##0.0E+0"));a.push(new IW("# ?/?"));a.push(new IW("# ??/??"));a.push(new IW('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new IW('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new IW('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new IW('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};M$e.prototype.t1=function(){var a=new ag;a.setType(2);I(a,3,1);var b=this.input.getValue();I(a,2,b);return a};function N$e(a){var b=a.description;a=a.XVb;return V('<div class="waffle-dv-rec-chip" title="'+W(b)+'"><div class="waffle-dv-rec-range">'+U(a)+'</div><div class="waffle-dv-rec-description">'+U(b)+"</div></div>")}function O$e(){return V('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function P$e(){var a=new pR(null);a.Vj(!0);return a};function Q$e(a,b,c){M.call(this);this.Cb=B(A(),"docs-egmd");this.D=a;this.qh=b;this.Jb=c;this.R=this.H=this.Da=this.Ba=this.V=this.F=null;this.kc=new JA;this.qa(this.kc);this.Wd=new JA;this.qa(this.Wd);this.va=this.O=null;this.ud=new JA;this.qa(this.ud);this.Re=new JA;this.qa(this.Re);this.Qa=this.La=this.Oa=this.ea=this.L=null;this.Hd=new JA;this.qa(this.Hd);this.Od=new JA;this.qa(this.Od);this.Pc=new JA;this.qa(this.Pc);this.Ce=new JA;this.qa(this.Ce);this.Ta=this.Ec=null;this.C=new xZ("");this.qa(this.C);
this.Ya=this.J=this.yb=this.cb=this.vf=this.tc=this.Ub=this.Xa=null;this.yg=this.Vc=!1;this.Vb=this.yf=this.Sa=this.bb=null;this.Vd=new cn(this);this.qa(this.Vd);this.Uh=new Xj;this.Wf=this.Gh=this.ah=this.Of=this.uh=this.Ha=null;this.Su();a=this.Vd;a.listen(this.F,"action",this.fpb);a.listen(this.V,"action",this.Pma);a.listen(this.Ba,"action",this.Pma);a.listen(this.Da,"action",this.Pma);a.listen(this.J,"focus",La(this.HSa,!0));a.listen(this.J,"blur",La(this.HSa,!1));a.listen(this.J,"change",this.Dma);
a.listen(this.J,"keyup",this.Dma);b=[this.O,this.va,this.H,this.R,this.L,this.ea,this.La,this.Qa];for(c=0;c<b.length;c++)this.Vd.listen(b[c],"change",v(this.uLb,this,b[c])),this.Vd.listen(b[c],"keyup",v(this.apb,this,b[c]));a.listen(this.Sa,"change",v(this.bJa,this));a.listen(this.Oa,"change",v(this.nBb,this));a.Cg(this.Ya,Zm,this.rwb)}x(Q$e,M);var R$e="placeholder"in document.createElement("input");
function S$e(a){var b=a.Wf;b||(b=[{Wj:"List from a range",type:4},{Wj:"List of items",type:3},{Wj:"Number",type:0},{Wj:"Text",type:1},{Wj:"Date",type:2},{Wj:"Custom formula is",type:5},{Wj:"Tick box",type:6}],a.Wf=b);return b}
function T$e(a){var b=a.Gh;b||(b=[{Wj:"contains",code:9,inputs:0,example:"Approved"},{Wj:"does not contain",code:10,inputs:0,example:"Approved"},{Wj:"equals",code:13,inputs:0,example:"Approved"},{Wj:"is a valid email",code:14,inputs:-1,example:null},{Wj:"is a valid URL",code:15,inputs:-1,example:null}],a.Gh=b);return b}
function U$e(a){var b=a.Of;if(!b){b=a.Cb?"11/2017":"15/11/2014";var c=a.Cb?"11/2018":"15/11/2015",d=a.Cb?"11/2017":"15/11/2014";b=[{Wj:"is a valid date",code:30,inputs:-1,example:null},{Wj:"equal to",code:16,inputs:2,example:d},{Wj:"before",code:17,inputs:2,example:d},{Wj:"on or before",code:19,inputs:2,example:d},{Wj:"after",code:18,inputs:2,example:d},{Wj:"on or after",code:20,inputs:2,example:d},{Wj:"between",code:21,inputs:3,example:b,eR:c},{Wj:"not between",code:22,inputs:3,example:b,eR:c}];
a.Of=b}return b}function V$e(a){var b=a.ah;b||(b=[{Wj:"range",code:23,inputs:6,example:null},{Wj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.ah=b);return b}
function W$e(a){var b=a.uh;b||(b=[{Wj:"between",code:7,inputs:8,example:"10",eR:"100"},{Wj:"not between",code:8,inputs:8,example:"10",eR:"100"},{Wj:"less than",code:3,inputs:7,example:"10"},{Wj:"less than or equal to",code:4,inputs:7,example:"10"},{Wj:"greater than",code:1,inputs:7,example:"10"},{Wj:"greater than or equal to",code:2,inputs:7,example:"10"},{Wj:"equal to",code:5,inputs:7,example:"10"},{Wj:"not equal to",code:6,inputs:7,example:"10"}],a.uh=b);return b}
function X$e(){return{Wj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function Y$e(){return{Wj:"",code:31,inputs:-1,example:""}}r=Q$e.prototype;
r.Su=function(){var a=this.D,b,c,d,e,f,h,k,l,m,p,q,t,w,y,D=a.oa(),O;var S=D.Aa("TR","waffle-dv-trrules",D.Aa("TD","waffle-dv-label",D.Aa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),D.Aa("TD",{colspan:"7"},l=D.Aa("DIV","goog-inline-block"),O=D.Aa("DIV","goog-inline-block"),h=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=D.Aa("SPAN","waffle-dv-separator","and"),k=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.Pc.Va(h);this.Ce.Va(k);this.ud.Va(c);this.Re.Va(d);this.kc.Va(e);this.Wd.Va(f);var T=P$e();Rw(T,l);var fa=P$e();Rw(fa,l);var la=P$e();Rw(la,l);var qa=P$e();Rw(qa,l);var Ka=Z$e(a,O);(t=T.getElement())&&ex(t,"labelledby",
"waffle-dv-criteria");var Fa;var Ua=D.Aa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",D.Aa("TD"),D.Aa("TD",{colspan:"7"},Fa=D.Aa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));t=$$e(this);kT(t,Fa);Rw(t,Fa);var Za=D.Aa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",D.Aa("TD"),D.Aa("TD",{colspan:"7"},m=D.Aa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Ha=$$e(this);kT(Ha,m);Rw(Ha,m);var Va=D.Aa("TR","waffle-dv-trrules",
D.Aa("TD"),D.Aa("TD","waffle-dv-customcheckboxlabel",D.Aa("SPAN",{id:"customCheckboxInputLabel_checked"},"Ticked:")),D.Aa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},p=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Ta=D.Aa("TR","waffle-dv-trrules",D.Aa("TD"),D.Aa("TD","waffle-dv-customcheckboxlabel",D.Aa("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unticked:")),D.Aa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},q=D.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));
this.Hd.Va(p);this.Od.Va(q);ex(p,"labelledby","customCheckboxInputLabel_checked");ex(q,"labelledby","customCheckboxInputLabel_unchecked");mW(this.Hd,"e.g. TRUE");mW(this.Od,"e.g. FALSE");var Ob=D.Aa("TR","waffle-dv-trrules",D.Aa("TD","waffle-dv-label",D.Aa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),D.Aa("TD",{colspan:"7"},D.Aa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},D.Aa("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",
name:"onInvalidData",role:"radio"}),D.Aa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),D.Aa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),D.Aa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new j1d;k1d(m,"onInvalidData",Ob);var Mb=D.Aa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",D.Aa("TD",null,D.Aa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),D.Aa("TD",{colspan:"7"},w=D.Aa("SPAN",
"waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));var Rb=$$e(this);kT(Rb,w);Rw(Rb,w);w=Rb.Ma();var Tb=H_a(w,"labelledby");ex(w,"labelledby","waffle-dv-appearance "+Tb);w=D.Aa("TR","waffle-dv-trrules",D.Aa("TD"),D.Aa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},y=D.Aa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Tb=D.Aa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));kv(Tb,!0);a=a.ea.childNodes[0];
D.appendChild(a,S);D.appendChild(a,Ua);D.appendChild(a,Za);D.appendChild(a,Va);D.appendChild(a,Ta);D.appendChild(a,Ob);D.appendChild(a,Mb);D.appendChild(a,w);this.C.render(l);D=this.C;D.xpa=this.Cb?36:29;D.resize();D=this.C;D.gpa=200;D.resize();this.C.getElement().style.width="324px";R$e?this.C.getElement().placeholder="Enter items separated by a comma...":(D=this.C.getElement(),ry(D,"Enter items separated by a comma...","Enter items separated by a comma..."));if(D=this.C.getElement())hx(D,"Enter items separated by a comma..."),
rx(D,["waffle-dv-list-options-textarea","jfk-textinput"]);this.J=y;T.setVisible(!0);D=S$e(this);aaf(this,D,T);D=W$e(this);aaf(this,D,qa);D=T$e(this);aaf(this,D,fa);D=U$e(this);aaf(this,D,la);baf(this,T,qa,fa,la,h,k,c,d,e,f,b,l,Ka,Ua,w,t,Fa,Tb,Rb,O,m,Ha,p,q,Za,Va,Ta)};
function baf(a,b,c,d,e,f,h,k,l,m,p,q,t,w,y,D,O,S,T,fa,la,qa,Ka,Fa,Ua,Za,Ha,Va){a.F=b;a.F.setVisible(!0);a.Ba=c;a.V=e;a.Da=d;a.Ec=q;a.L=f;a.ea=h;a.O=k;a.va=l;a.H=m;a.R=p;a.Ta=t;a.Ha=w;a.Xa=la;a.Oa=Ka;a.La=Fa;a.Qa=Ua;a.vf=Za;a.cb=Ha;a.yb=Va;N(a.vf,!1);N(a.cb,!1);N(a.yb,!1);fa.gc(!1);a.Sa=fa;a.Vb=qa;caf(a,!1);a.Ub=y;O.gc(!0);a.bb=O;a.yf=S;a.tc=D;N(a.tc,!0);daf(a);eaf(a);a.Ya=T;N(a.Ya,!1)}
function faf(a,b){N(a.Ub,23==b||24==b);a.yf.innerText="Show drop-down list in cell";b=31==b;N(a.vf,b);var c=a.Oa.isChecked();N(a.cb,b&&c);N(a.yb,b&&c)}function aaf(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa();e=new Yx(b[d].Wj,null,e);c.Qc(e);dx(e.getElement(),"menuitem")}c.ef(0)}r.Pma=function(){eaf(this);this.J.value=gaf(this);this.dispatchEvent("change")};r.fpb=function(){daf(this);eaf(this);this.J.value=gaf(this);this.dispatchEvent("change")};r.HSa=ca("yg");
r.Dma=function(a){this.Vc||a&&!K_a(a)||this.J.value===haf(this)||(this.Vc=!0,N(this.Ya,!0))};r.rwb=function(){this.Vc=!1;this.J.value=gaf(this);N(this.Ya,!1)};r.bJa=function(){N(this.tc,this.Sa.isChecked())};r.nBb=function(){var a=this.Oa.isChecked();a||iaf(this);N(this.cb,a);N(this.yb,a);jaf(this)};function jaf(a){a.J.value=gaf(a)}function kaf(a){jaf(a);a.C.resize()}r.uLb=function(a){jaf(this);laf(this,a)?(this.D.Tm=0,G5(a),this.dispatchEvent("change")):(this.D.Tm=1,H5(a),this.dispatchEvent("error"))};
r.apb=function(){this.dispatchEvent("keyup")};function laf(a,b){if(0!=I5(a))return!0;var c=b.value;if(null!=c&&Iw(b)){if(!maf(a.D))return!0;a=J5(a,c,naf(a).code);return null!=a&&(Tf(a,3)||Tf(a,5)&&a.iq().hasValue()&&3==H(a.iq().getValue(),1))}return!0}function H5(a){a.select();Q(a,"waffle-input-error")}function G5(a){a&&sx(a,"waffle-input-error")}function iaf(a){G5(a.C.getElement());G5(a.H);G5(a.R);G5(a.L);G5(a.ea);G5(a.La);G5(a.O);G5(a.va);G5(a.Ha.Os());a.D.Tm=0;a.dispatchEvent("change")}
function oaf(a,b){return a.Cb?b:"e.g. "+b}function I5(a){return S$e(a)[a.F.Kh()].type}function daf(a){var b=I5(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.V.setVisible(c);a.Ba.setVisible(d);a.Da.setVisible(e);N(a.Ta,f);N(a.Xa,h);N(a.L,!1);N(a.ea,!1);N(a.O,!1);N(a.va,!1);N(a.H,!1);N(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function naf(a){var b;null!=paf(a)?b=paf(a):a.V.isVisible()?b=U$e(a)[a.V.Kh()]:a.Ba.isVisible()?b=W$e(a)[a.Ba.Kh()]:5==I5(a)?b=X$e():6==I5(a)?b=Y$e():b=T$e(a)[a.Da.Kh()];return b}function paf(a){var b=V$e(a);return 4==I5(a)?b[0]:3==I5(a)?b[1]:null}
function eaf(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,p=naf(a);-1!=p.inputs&&(0==p.inputs?d=!0:1==p.inputs?k=e=d=!0:2==p.inputs?f=!0:3==p.inputs?k=h=f=!0:7==p.inputs?b=!0:8==p.inputs?k=c=b=!0:5==p.inputs?l=!0:6==p.inputs&&(m=!0));var q=naf(a);if(3==I5(a))R$e?a.C.getElement().placeholder="Enter items separated by a comma...":(q=a.C.getElement(),ry(q,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(q.example)if(0==q.inputs||1==q.inputs)mW(a.ud,oaf(a,q.example)),
mW(a.Re,oaf(a,q.eR)||"");else if(2==q.inputs||3==q.inputs)mW(a.kc,oaf(a,q.example)),mW(a.Wd,oaf(a,q.eR)||"");else if(7==q.inputs||8==q.inputs)mW(a.Pc,oaf(a,q.example)),mW(a.Ce,oaf(a,q.eR)||"");iaf(a);N(a.L,b);N(a.ea,c);N(a.O,d);N(a.va,e);N(a.H,f);N(a.R,h);N(a.Ta,l);l&&a.C.resize();N(a.Xa,m);faf(a,p.code);N(a.Ec,k)}
function J5(a,b,c){var d=maf(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.Ac();e=e.xc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.Uh.Tc(sg.xa(),b):null}
function qaf(a){var b=new wg,c=naf(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(J5(a,a.O.value,d));break;case 1:e.push(J5(a,a.O.value,d));e.push(J5(a,a.va.value,d));break;case 2:e.push(J5(a,a.H.value,d));break;case 3:e.push(J5(a,a.H.value,d));e.push(J5(a,a.R.value,d));break;case 7:e.push(J5(a,a.L.value,d));break;case 8:e.push(J5(a,a.L.value,d));e.push(J5(a,a.ea.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(ETd(a[c]));break;case 6:c=X8b("="+a.Ha.getValue());e.push(J5(a,
c,d));break;case -1:a.Oa.isChecked()&&(e.push(J5(a,Ad(a.La.value),d)),zd(a.Qa.value)||e.push(J5(a,Ad(a.Qa.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=TH(d,e);I(b,1,d);return b}function raf(a){var b=Ad(a.Ha.getValue());!a.Jb.D.D[Ad(df(b).toLowerCase())]&&RQd(a.Jb,b)&&(b=UQd(a.Jb,b,!0));return b}function gaf(a){return a.Vc||a.yg?a.J.value:haf(a)}
function haf(a){var b="";var c=I5(a);var d=4==c;c=3==c||4==c;if(a.V.isVisible())c=U$e(a)[a.V.Kh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Da.isVisible())c=T$e(a)[a.Da.Kh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that ";else if(c)c=paf(a),b+="Click and enter a value from ";else if(5==I5(a))c=X$e(),b="Enter a value that satisfies the formula:";else if(6==I5(a))if(c=Y$e(),a.Oa.isChecked()&&!zd(Ad(a.La.value))){b=Ad(a.La.value);var e=
Ad(a.Qa.value);b=zd(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=W$e(a)[a.Ba.Kh()],b+="Enter a number ";-1!=c.inputs&&(b+=c.Wj);e=raf(a);23==c.code&&""!=e&&d&&(d=UQd(a.Jb,e,!0))&&(b+=" "+d);zd(df(a.O.value))||0!=c.inputs&&1!=c.inputs?zd(df(a.H.value))||2!=c.inputs&&3!=c.inputs?zd(df(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;zd(df(a.va.value))||1!=c.inputs?zd(df(a.R.value))||3!=c.inputs?zd(df(a.ea.value))||
8!=c.inputs||(b+=" and "+a.ea.value):b+=" and "+a.R.value:b+=" and "+a.va.value;return b}function caf(a,b){l1d(a.Vb,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function saf(a,b){switch(b){case 0:a.F.ef(2);break;case 1:a.F.ef(3);break;case 2:a.F.ef(4);break;case 3:a.F.ef(1);break;case 4:a.F.ef(0);break;case 5:a.F.ef(5);break;case 6:a.F.ef(6)}}
function taf(a,b,c,d,e){a.F.ef(0);a.V.ef(0);a.Ba.ef(0);a.Da.ef(0);a.J.value="";a.L.value="";a.ea.value="";a.H.value="";a.R.value="";a.O.value="";a.va.value="";a.C.setValue("");a.Ha.setValue("");caf(a,!1);var f=a.Vc=!1,h=!1,k=!1,l=!1,m=!1,p=!1,q=!1,t=!1,w=!1,y=!1,D=!1,O=!1,S=!1,T=!1,fa=!1,la=!1,qa=!1,Ka=!1,Fa=b&&xg(b);b=Fa&&ug(Fa);if((Fa=Fa&&vg(Fa))&&b){for(var Ua=V$e(a),Za=U$e(a),Ha=W$e(a),Va=T$e(a),Ta=X$e(),Ob=Y$e(),Mb=0,Rb=0;Rb<Ua.length;Rb++)if(b==Ua[Rb].code){Mb=Ua[Rb].inputs;23==Ua[Rb].code?
(la=!0,saf(a,4)):(O=!0,saf(a,3));a.bb.gc(!!e);break}for(e=0;e<Za.length;e++)if(b==Za[e].code){Mb=Za[e].inputs;a.V.ef(e);saf(a,2);S=t=!0;break}for(e=0;e<Ha.length;e++)if(b==Ha[e].code){Mb=Ha[e].inputs;a.Ba.ef(e);saf(a,0);T=w=!0;break}for(e=0;e<Va.length;e++)if(b==Va[e].code){Mb=Va[e].inputs;a.Da.ef(e);saf(a,1);fa=y=!0;break}b==Ta.code&&(Mb=Ta.inputs,saf(a,5),qa=!0);b==Ob.code&&(Mb=Ob.inputs,saf(a,6),Ka=!0);if(S||fa||T||O||la||qa||Ka)if(fa=maf(a.D),S=fa.rect.Ac(),T=fa.rect.xc(),fa=fa.C,-1==Mb)Ka&&0<
Fa.length&&(D=!0,a.Oa.gc(!0),a.Hd.setValue(UH(Fa[0],fa,S,T)),1<Fa.length&&a.Od.setValue(UH(Fa[1],fa,S,T)));else if(0==Mb)m=UH(Fa[0],fa,S,T),a.ud.setValue(m),m=!0;else if(1==Mb)p=UH(Fa[0],fa,S,T),m=UH(Fa[1],fa,S,T),a.ud.setValue(p),a.Re.setValue(m),p=m=q=!0;else if(2==Mb)f=UH(Fa[0],fa,S,T),a.kc.setValue(f),f=!0;else if(3==Mb)h=UH(Fa[0],fa,S,T),f=UH(Fa[1],fa,S,T),a.kc.setValue(h),a.Wd.setValue(f),h=f=q=!0;else if(7==Mb)k=UH(Fa[0],fa,S,T),a.Pc.setValue(k),k=!0;else if(8==Mb)l=UH(Fa[0],fa,S,T),k=UH(Fa[1],
fa,S,T),a.Pc.setValue(l),a.Ce.setValue(k),l=k=q=!0;else if(5==Mb){O=!0;Ka=[];for(Mb=0;Mb<Fa.length;Mb++)Ka.push(UH(Fa[Mb],fa,S,T));a.C.setValue(Ka.join(","));a.C.resize()}else 6==Mb&&(la=!0,Ka=UH(Fa[0],fa,S,T),null!=Ka&&(Ka=Ka.substring(1),Fa=!!RN(Ka),Ka=(Mb=TN(Ka,a.qh,!1,!0))?VN(Mb.rect,tM(a.qh,Mb.C).Yd()):Ka,Fa||(Ka=SN(Ka)),a.Ha.setValue(Ka)));else a.F.ef(0),la=!0;N(a.Ec,q);a.V.setVisible(t);a.Ba.setVisible(w);a.Da.setVisible(y);N(a.H,f);N(a.R,h);N(a.O,m);N(a.va,p);N(a.L,k);N(a.ea,l);N(a.cb,D);
N(a.yb,D);N(a.Ub,!0);N(a.Ta,O);a.C.resize();N(a.Xa,la);null!=b&&faf(a,b)}else baf(a,a.F,a.Ba,a.Da,a.V,a.L,a.ea,a.O,a.va,a.H,a.R,a.Ec,a.Ta,a.Ha,a.Ub,a.tc,a.bb,a.yf,a.Ya,a.Sa,a.Xa,a.Vb,a.Oa,a.La,a.Qa,a.vf,a.cb,a.yb);a.bJa();c=c||"";t=c.lastIndexOf("</strong>");-1!=t&&(c=Ze(Ad(c.substring(t+9))));a.Sa.gc(!!c);c&&(gaf(a)!=c&&a.Dma(),a.J.value=c,N(a.tc,!0));caf(a,d)}function $$e(a){var b=a.D.oa();return a.Cb?new lT(!1,mT.getInstance(),b):new nT}
r.Ja=function(){this.Ub=this.bb=this.Ya=this.J=this.Ec=this.Qa=this.La=this.ea=this.L=this.va=this.O=this.R=this.H=null;F(this.Ha);this.Ha=null;F(this.bb);this.bb=null;F(this.Da);this.Da=null;F(this.Ba);this.Ba=null;F(this.V);this.V=null;F(this.F);this.F=null;F(this.Sa);this.Sa=null;F(this.Vb);this.Vb=null;Q$e.Ia.Ja.call(this)};function uaf(a,b,c,d,e,f,h){cB.call(this);this.cb=a;this.Vd=b;this.Ya=c;this.Pc=d;this.R=e;this.Sa=f;this.Ha=h;this.V=new P(this.oa());this.Fa(this.V);this.Jb=new Ux("",new sV,this.oa());this.Fa(this.Jb);this.Ta=new P(this.oa());this.Fa(this.Ta);this.$d=new fV(!1,"#4285f4");this.Fa(this.$d);this.Ub=new mQ(c,"waffle-dv-highlight-styled-border","waffle-dv-highlight-styled-rect");this.qa(this.Ub);this.F=this.ea=null;this.Vb=new cn(this);this.qa(this.Vb);this.bb=this.L=this.J=this.C=null;this.va=B(A(),
"fedvs");this.Xa=this.O=null;this.yb=-1;this.tc=[];this.kc=[];this.Vc=-1;a=cL(this.Ya).Lc();this.ud=Pl(a.Ac(),a.xc(),a.Zc(),a.cd());this.Cb=!1;this.Ec=new cn(this);this.qa(this.Ec);this.L=new Tz;B(A(),"docs-egmd")?(this.L.set("cancel","Cancel",!1,!0),this.L.set("clear","Remove validation"),this.L.set("save","Save")):(this.L.set("save","Save"),this.L.set("clear","Remove validation"),this.L.set("cancel","Cancel",!1,!0));Wz(this,this.L);Sz(this,!1);this.render();Q(Qz(this),"waffle-data-validation-dialog");
a=this.Fb();b=this.oa();this.setTitle("Data validation");this.J||(c=b.Aa("DIV",{"class":"waffle-input-error-butter-wrap"}),d=b.Aa("DIV",{"class":"waffle-input-error-butter-container"},c),b.appendChild(a,d),this.J=new iA(d),this.J.setType("warning"),this.J.setContent(""),this.J.render(c),X4a(this.J,!0),this.J.setVisible(!1));this.va&&(d=b.Aa("DIV","waffle-dv-recs-title-bar"),e=b.Aa("DIV",{id:vaf.Vwa},"Suggested validations"),c=b.Aa("DIV","waffle-dv-rec-wrapper"),f=b.Aa("DIV","waffle-dv-feedback-link",
"Send feedback"),b.appendChild(a,d),b.appendChild(d,f),b.appendChild(d,e),b.appendChild(a,c),this.Jb.Va(f),N(f,UB),this.V.Va(c),d=b.Aa("DIV","waffle-dv-rec-spinner-container"),b.appendChild(c,d),this.Ta.Va(d),this.$d.render(d),this.$d.setActive(!0));this.ea=b.Aa("TABLE",{cellSpacing:"0","class":"waffle-dv-table"},b.Aa("TBODY"));b.appendChild(a,this.ea);this.va&&Q(this.ea,"waffle-dv-table-with-suggestions");a=this.Fb();a=Ju(a);b=a.Aa("TR","waffle-dv-trrules");b.appendChild(a.Aa("TD","waffle-dv-label",
a.Aa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Aa("TD",{colspan:"7"});this.C=Z$e(this,c);waf(this);b.appendChild(c);a.appendChild(this.ea.childNodes[0],b);(a=this.C.Os())&&ex(a,"labelledby","waffle-dv-cell-range");this.F=new Q$e(this,this.cb,this.R);dA(this,"save");xaf(this)}x(uaf,cB);var vaf={Vwa:"waffle-dv-recs-title"};r=uaf.prototype;r.Tm=0;function waf(a){if(a.C){var b=a.cb.getActiveGrid();b&&(b=VN(cL(a.Ya).Lc(),b.Yd(),!0),a.C.setValue(b))}}
function xaf(a){a.Vb.listen(a,"dialogselect",a.tLb).listen(a.F,"error",a.$ob).listen(a.F,"change",a.sLb).listen(a.C,"change",function(){a.F&&jaf(a.F);if(a.va){var b=maf(a);a.Cb||a.O&&b&&b.intersects(IY(a.R,a.Xa))||yaf(a)}});a.va&&a.Vb.listen(a.Sa,"recommender-calc-ended",a.rLb).listen(a.Jb,"action",function(){(Hu(),zt).Gb({source:"dataValidationDialogFeedback"})})}r.$ob=function(){zaf(this)};r.sLb=function(){zaf(this);Zz(this.L,"save",!0)};
function Aaf(a){var b=a.oa();a=a.V.Ma();var c=R(O$e);b.appendChild(a,c)}
r.rLb=function(a){var b=this;this.$d.setActive(!1);N(this.Ta.Ma(),!1);a=a.C;if(0==a.length)Aaf(this);else for(var c=this.oa(),d=this.V.Ma(),e=0,f={PP:0};f.PP<a.length;f={uK:f.uK,FC:f.FC,oW:f.oW,PP:f.PP,d4:f.d4,DC:f.DC},f.PP++){var h=a[f.PP],k=H(h,13);if(3<=e||!k)break;e++;f.d4=GK(h);f.oW=VN(pm(f.d4));f.FC=H(k,3);this.tc.push(f.FC);this.kc.push(f.oW);h="";switch(ug(f.FC)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+vg(f.FC).map(function(l){return H(l.iq().getValue(),
2)}).join();break;case 1:h="Greater than "+H(vg(f.FC)[0].iq().getValue(),3);break;case 7:h=vg(f.FC);h="Between "+(H(h[0].iq().getValue(),3)+(" and "+H(h[1].iq().getValue(),3)));break;case 5:h=vg(f.FC),h="Equal to "+H(h[0].iq().getValue(),3)}k=vaf;f.DC=R(N$e,{description:h,XVb:f.oW});f.uK=new Az("",c);f.uK.hf(8,!0);f.uK.Va(f.DC);ex(f.DC,"describedby",k.Vwa);this.V.Fa(f.uK);c.appendChild(d,f.DC);this.Ec.listen(f.uK,"action",function(l){return function(){Baf(b,l.uK,l.FC,l.oW,l.PP)}}(f)).listen(f.DC,
"mouseenter",function(l){return function(){OY(b.Ub,om(l.d4))}}(f)).listen(f.DC,"mouseleave",function(){nQ(b.Ub)}).listen(f.DC,"focus",function(l){return function(){zw(l.DC,d)}}(f))}};
function Baf(a,b,c,d,e){var f=nx(b.Ma(),"waffle-dv-rec-chip-selected");a.V.Ve(function(h){h.sj("waffle-dv-rec-chip-selected",!1);h.hc(!1)});b.sj("waffle-dv-rec-chip-selected",!f);b.hc(!f);a.Cb=!0;f?(a.show(!0),a.O=null,a.Xa=null,a.yb=-1):(b=new wg,I(b,1,c),taf(a.F,b,null,null,!0),kaf(a.F),a.C.setValue(d),a.O=c,a.Xa=d,a.yb=e);a.Cb=!1}r.tLb=function(a){if("save"==a.key){if(!Caf(this)){a.preventDefault();return}}else if("clear"==a.key&&!Daf(this)){a.preventDefault();return}this.C&&this.C.Na(!1)};
function zaf(a){var b=Eaf(a.Tm);b&&a.J.setContent(b);a.J.setVisible(0!=a.Tm);b=2==a.Tm||4==a.Tm;var c=a.oa().sx(a.C.getElement());ux(c,"waffle-input-error",b);b&&a.C.Os().select()}
function Eaf(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid ticked value.";case 9:return"Enter different values for ticked and unticked cell contents.";case 10:return"Formulas are not permitted as custom ticked/unticked values."}return null}
function Faf(a){var b=a.F,c=I5(b);if(0==c){c=b.L;var d=b.ea,e=laf(b,c),f=laf(b,d);e&&f?b.D.Tm=0:(e||H5(c),f||H5(d),b.D.Tm=1)}else if(1==c)c=b.O,d=b.va,e=!Iw(c)||!zd(df(c.value)),f=!Iw(d)||!zd(df(d.value)),e&&f?b.D.Tm=0:(e||H5(c),f||H5(d),b.D.Tm=6);else if(2==c)c=b.H,d=b.R,e=!Iw(c)||!zd(df(c.value)),f=!Iw(d)||!zd(df(d.value)),e&&f?b.D.Tm=0:(e||H5(c),f||H5(d),b.D.Tm=7);else if(3==c||4==c)c=0,4==I5(b)?(d=raf(b),RQd(b.Jb,d)?(d=raf(b),d=IY(b.Jb,d),e=maf(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==I5(b)&&b.C.getElement()&&zd(df(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.Tm=d,d=b.Xa&&Iw(b.Xa),b.Ta&&Iw(b.Ta)?(ux(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().sx(b.Ha.getElement()),ux(d,"waffle-input-error",!c),b.Ha.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Oa.isChecked()){c=b.La;e=b.Qa;d=Ad(df(c.value));e=Ad(df(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==
e.toLowerCase();var h=kf(d)==kf(e);f=d==e||h||f;zd(d)?(H5(c),b.D.Tm=8):f?b.D.Tm=9:eF(d)||eF(e)?b.D.Tm=10:b.D.Tm=0}}else b.D.Tm=0;b=a.C.getValue();b=RQd(a.R,b);2==a.Tm&&b?a.Tm=0:0!=a.Tm||b||(a.Tm=2);zaf(a);return 0!=a.Tm}
function Gaf(a){switch(a){case 1:return 35283;case 2:return 35284;case 3:return 35285;case 4:return 35286;case 5:return 35282;case 6:return 35291;case 7:return 35271;case 8:return 35289;case 9:return 35272;case 10:return 35290;case 13:return 35292;case 14:return 35293;case 15:return 35294;case 16:return 35277;case 17:return 35275;case 18:return 35274;case 19:return 35280;case 20:return 35279;case 21:return 35276;case 22:return 35278;case 30:return 35281;case 23:return 35287;case 24:return 35288;case 31:return 35358;
case 29:return 35273}return null}
function Caf(a){if(Faf(a))return!1;var b=a.F,c=b.Vb.isChecked("rejectInvalidData_radio"),d=gaf(b);b.Sa.isChecked()||(d="");var e=qaf(b);if(!e)return!1;var f=new Zo;I(f,1,e);I(f,2,d);I(f,3,c);eQd(f,Iw(b.Ub)&&b.bb.isChecked());b=Haf(a);if(!b)return!1;d=new Ui;e=xg(e);var h=a.O&&ug(a.O)==ug(e);c=vg(e);if(h){var k=Iaf(a,P9e(a.R,a.Xa)),l=Jaf(a);k=qm(k,b);L(d,12,!l||!k);var m=new R9e;L(m,1,!k);L(m,2,!l);L(m,3,a.yb);Ii(d,17,Mma[0],m)}else{for(var p=m=k=l=!1,q=!1,t=0;t<a.kc.length;t++){var w=Iaf(a,P9e(a.R,
a.kc[t]));if(w){var y=qm(w,b);w=Rua(w,b);var D=a.tc[t],O=ug(D)==ug(e);D=vg(D);D=qd(D,c,function(S,T){return S.equals(T)});q=q||D;l=l||y&&O&&D;k=k||y;m=m||y&&O;p=p||w}}t=new S9e;L(t,1,l);L(t,2,k);L(t,3,m);L(t,4,p);L(t,5,q);Ii(d,18,Mma[0],t)}ZPd(d,fZd(ug(e)));l=ka(a.tc);for(k=l.next();!k.done;k=l.next())N9e(d,fZd(ug(k.value)));l=Ma()-a.Vc;L(d,14,l);l=new Qi;Hi(l,58,d);d=Ox(Px(new Nx,l),1).build();a.Ha.C(h?35578:35301,d);h=Gaf(ug(e));null!=h&&a.Ha.C(h);31==ug(e)&&a.Ha.C(0<c.length?35604:35603,d);a.Pc.C(new HZd(f,
b));return!0}function Jaf(a){var b=qaf(a.F);if(!b||!a.O)return!1;b=vg(xg(b));a=vg(a.O);return qd(a,b,function(c,d){return c.iq().getValue().equals(d.iq().getValue())})}
function Daf(a){var b=Haf(a);if(!b)return!1;try{if(!qaf(a.F))return a.Ha.C(35300),!0;var c=xg(qaf(a.F)),d=a.O&&ug(a.O)==ug(c),e=!1,f=new Ui;if(d){var h=CQb(cL(a.Ya).vp().Cc(),P9e(a.R,a.C.getValue()));Ak(h,function(p){zJ(p)&&(e=!0);return e});if(!e){var k=new S9e;L(k,6,!0);Ii(f,18,Mma[0],k)}}var l=new Qi;Hi(l,58,f);var m=Ox(Px(new Nx,l),1).build();a.Ha.C(35300,m);return!0}finally{a.Pc.C(new HZd(new Zo,b))}}function Haf(a){var b=P9e(a.R,a.C.getValue());return Iaf(a,b)}
function Iaf(a,b){var c=a.C.getValue();a=(a=IY(a.R,c))?a.C:null;return b&&null!=a?km(b,a):null}function maf(a){var b=a.C.getValue();return IY(a.R,b)}function Z$e(a,b){var c=a.cb.C.Yd();a=new HV(a.Ya,v(a.qLb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.oa());a.render(b);return a}r.setVisible=function(a){uaf.Ia.setVisible.call(this,a);a&&this.bb&&(this.bb.focus(),this.bb=null)};r.qLb=function(a,b,c,d){this.bb=a.Os();this.Vd.rf(this,a,b,c,!1,!0,d)};
r.show=function(a){var b="",c=!1,d=BM(this.cb),e=zJ(rJ(d,gK(d)));d=null;var f=!1;e&&(e=e.C,d=H(e,1),b=H(e,2),c=H(e,3),f=H(e,4));taf(this.F,d,b,c,f);(b=qaf(this.F))&&xg(b);this.setVisible(!0);this.C&&this.C.Na(!0);waf(this);kaf(this.F);yaf(this,a);this.Vc=Ma()};
function yaf(a,b){a.va&&!b&&(DPd(a.Sa)?(a.$d.setActive(!0),N(a.Ta.Ma(),!0),a.V.ld(!0),a.Ec.Dc(),aRd(a.Sa),b=maf(a),null==b||Wl(b.rect)||b.rect.equals(a.ud)?RRd(a.Sa,!0,!1,[6]):kRd(a.Sa,!0,!1,!1,[6],[maf(a).rect])):(a.$d.setActive(!1),N(a.Ta.Ma(),!1),Aaf(a)))}r.Ja=function(){F(this.F);this.F=null;F(this.C);this.L=this.ea=this.C=null;F(this.J);uaf.Ia.Ja.call(this)};function K5(a,b){cy.call(this,b,new Kaf(a))}x(K5,cy);r=K5.prototype;r.Cf=function(a,b,c){K5.Ia.Cf.call(this,a,b,c);a.Db()&&this.Db()&&a.getParent()==this&&Laf(this)};r.Ga=function(){K5.Ia.Ga.call(this);Laf(this)};r.Fc=function(a){K5.Ia.Fc.call(this,a);Laf(this)};r.removeChild=function(a,b){a=K5.Ia.removeChild.call(this,a,b);Laf(this);return a};r.Xl=function(a,b){a=K5.Ia.Xl.call(this,a,b);Laf(this);return a};
r.Ye=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Lx(this);if(c){b=39==b;this.Ee()&&(b=!b);c=c.getElement();c=Mc(c.parentNode.childNodes,c);var d=(d=(d=Lx(this))?jYa(d.getElement(),Maf):null)?Mc(d.parentNode.childNodes,d):-1;var e=d==(this.getElement()?this.getElement().childNodes.length:0)-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=Naf(this,e);b?b=Naf(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.dda(this.Zs()+b);b=!0}else b=!1}b=!b}return b?
K5.Ia.Ye.call(this,a):!0};function Naf(a,b){return 0==(a.getElement()?a.getElement().childNodes.length:0)?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function Laf(a){var b,c=a.Cd(),d=a.Oc(),e=hd(Ou("div",Maf,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.oa().Aa("DIV",Maf),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Oc();k++)a.Ic(k)instanceof by?(d.push(new Oaf(b,k,!0)),b=k+1):a.Ic(k)instanceof Wx&&(0==k?h=!0:(a.Ic(k-1),d.push(new Oaf(b,k-1,!1)),b=k));k=a.Oc();0<d.length&&Lc(d).end!=k-1&&d.push(new Oaf(b,k-1,!1));b=h;h=a.Oc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Oc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else Paf(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Oc();f++){for(;f>c[d];)++d;b=a.Ic(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof by?N(h,!1):N(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function Paf(a,b,c){function d(p){return p.end-p.start-(p.pCb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;cd(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,cd(a,l,1))}}function Oaf(a,b,c){this.start=a;this.end=b;this.pCb=c}function Kaf(a){ay.call(this);this.D=a}x(Kaf,ay);var Maf="docs-multi-menu-col";function Qaf(a){E.call(this);this.C=a}u(Qaf,E);Qaf.prototype.create=function(){return new K5(this.C)};function Raf(a,b){D5.call(this,a);this.ea=new P;this.H=new Saf;this.F=new P;a=(new Qaf(3)).create();a.Fa(new Wx("Date"),!0);a.Fa(new Yx("Day","DAY_TOKEN"),!0);a.Fa(new Yx("Month","MONTH_TOKEN"),!0);a.Fa(new Yx("Year","YEAR_TOKEN"),!0);a.Fa(new Wx("Time:"),!0);a.Fa(new Yx("Hours","HOURS_TOKEN"),!0);a.Fa(new Yx("Minutes","MINUTES_TOKEN"),!0);a.Fa(new Yx("Seconds","SECONDS_TOKEN"),!0);a.Fa(new Yx("Milliseconds","MILLIS_TOKEN"),!0);a.Fa(new Yx("a.m./p.m.","AM_PM_TOKEN"),!0);a.Fa(new Wx("Duration"),!0);
a.Fa(new Yx("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Fa(new Yx("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Fa(new Yx("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new drc(a);this.C=b}u(Raf,D5);r=Raf.prototype;r.Aa=function(){var a=R(B$e,{e0:Sw(this,"nfd-icwr"),WK:Sw(this,"nfd-a")});this.sb(a)};
r.Ga=function(){D5.prototype.Ga.call(this);Q(this.getElement(),"nfd-date-time-input");var a=Uw(this,"nfd-icwr"),b=this.ea;b.Va(a);b.Rd(this);b.Fa(this.L,!0);Q(this.L.getElement(),"nfd-date-time-menu-button");Q(this.L.Tb().getElement(),"nfd-date-time-menu");hx(this.L.Ma(),"Add a date or time format");b.Fa(this.H,!0);C.vd||Q(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Fa(a,!0);rw(a.getElement(),"display","inline");this.getHandler().listen(this,"Kh",La(this.pNa,"left")).listen(this,"Oh",
La(this.pIa,"left")).listen(this,"Ph",La(this.pIa,"right")).listen(this,"Qh",La(this.jJa,"left")).listen(this,"Rh",La(this.jJa,"right")).listen(this,"Nh",La(this.pNa,"right")).listen(this.L,"action",this.Ojb)};r.wCa=function(){this.ea.getElement().focus()};
r.lP=function(a){this.Pb(a.clone());var b=this.F;b.ld(!0);jv(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Pl());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?jv(this.H.getElement(),d[2]):(e=b.Ic(b.Oc()-1),d=d[2],jv(e.eC.getElement(),mv(e.eC.getElement())+d)):Taf(this,e).setValue(d[1])}0<b.Oc()&&b.Ic(b.Oc()-1).Ez.getElement().focus()};
r.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.Oc();b++)a+=this.F.Ic(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=nga(e,"["),e=nga(e,"]")):c=!0}b+=e}return b};r.Ojb=function(a){a=a.target.getValue();Taf(this,a).Ez.getElement().focus()};
function Taf(a,b){s$e(a,!1);switch(b){case "DAY_TOKEN":var c=Uaf(a);break;case "MONTH_TOKEN":c=Vaf(a);break;case "YEAR_TOKEN":c=Waf(a);break;case "HOURS_TOKEN":c=Xaf();break;case "MINUTES_TOKEN":c=Yaf();break;case "SECONDS_TOKEN":c=Zaf();break;case "MILLIS_TOKEN":c=$af();break;case "AM_PM_TOKEN":c=abf(a);break;case "ELAPSED_HOURS_TOKEN":c=bbf();break;case "ELAPSED_MINUTES_TOKEN":c=cbf();break;case "ELAPSED_SECONDS_TOKEN":c=dbf()}b=c;b.Fa(new by,!0);b.Fa(new Yx("Delete"),!0);c=new ebf(c,"");a.F.Fa(c,
!0);return c}r.pNa=function(a,b){b=b.target;if(b instanceof Saf){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Ic(Vw(this.F,b)+1),!b))return}a=mv(b.eC.getElement());var c=b.getParent(),d=Vw(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=mv(b),jv(b,c+a),fbf(this.H,c.length)):(d--,b=c.Ic(d),c=mv(b.eC.getElement()),jv(b.eC.getElement(),mv(b.eC.getElement())+a),fbf(b.eC,c.length))};
r.jJa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Ic(Vw(this.F,b)+a))&&a.Ez.getElement().focus()};r.pIa=function(a,b){var c="left"==a?-1:0;(b=this.F.Ic(Vw(this.F,b.target)+c))||"left"!=a?b&&(b=b.eC):b=this.H;c=mv(b.getElement()).length;fbf(b,"left"==a?c:0)};
function Uaf(a){function b(f){return"Day ("+(f+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Day without leading zero ("+(e+")"),d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Day with leading zero ("+(e+")"),d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Day as abbreviation ("+(e+")"),d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,
e),"Day as full name ("+(e+")"),d));a=new cy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Vaf(a){function b(f){return"Month ("+(f+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Month without leading zero ("+(e+")"),d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Month with leading zero ("+(e+")"),d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Month as abbreviation ("+(e+")"),d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,
e),"Month as full name ("+(e+")"),d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"First letter of the month ("+(e+")"),d));a=new cy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Waf(a){function b(f){return"Year ("+(f+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Two-digit year ("+(e+")"),d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Full numeric year ("+(e+")"),d));a=new cy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Xaf(){function a(e){return"Hour ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Hour without leading zero ("+(c+")"),"h"));c="01";b.push(new F5(La(a,c),"Hour with leading zero ("+(c+")"),"hh"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Yaf(){function a(e){return"Minute ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Minute without leading zero ("+(c+")"),"m"));c="01";b.push(new F5(La(a,c),"Minute with leading zero ("+(c+")"),"mm"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Zaf(){function a(e){return"Second ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Second without leading zero ("+(c+")"),"s"));c="01";b.push(new F5(La(a,c),"Second with leading zero ("+(c+")"),"ss"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function $af(){function a(e){return"Milliseconds ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Precision to 1/10 of a second ("+(c+")"),"0"));c="01";b.push(new F5(La(a,c),"Precision to 1/100 of a second ("+(c+")"),"00"));c="001";b.push(new F5(La(a,c),"Precision to 1/1000 of a second ("+(c+")"),"000"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function abf(a){function b(f){return"a.m./p.m. ("+(f+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Full ("+(e+")"),d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Shortened lowercase ("+(e+")"),d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new F5(La(b,e),"Shortened uppercase ("+(e+")"),d));a=new cy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function bbf(){function a(e){return"Elapsed hours ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Elapsed hours without leading zero ("+(c+")"),"[h]"));c="01";b.push(new F5(La(a,c),"Elapsed hours with leading zero ("+(c+")"),"[hh]"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function cbf(){function a(e){return"Elapsed minutes ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Elapsed minutes without leading zero ("+(c+")"),"[m]"));c="01";b.push(new F5(La(a,c),"Elapsed minutes with leading zero ("+(c+")"),"[mm]"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function dbf(){function a(e){return"Elapsed seconds ("+(e+")")}var b=[],c="1";b.push(new F5(La(a,c),"Elapsed seconds without leading zero ("+(c+")"),"[s]"));c="01";b.push(new F5(La(a,c),"Elapsed seconds with leading zero ("+(c+")"),"[ss]"));c=new cy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}function ebf(a,b){P.call(this);this.Ez=new pR("",a);this.Fa(this.Ez,!0);this.eC=new Saf(b);this.Fa(this.eC,!0)}u(ebf,P);r=ebf.prototype;
r.Ga=function(){P.prototype.Ga.call(this);Q(this.getElement(),"nfd-date-time-pill");rw(this.getElement(),"display","inline-block");this.Ez.ef(0);this.Qd=new jx(this.Ez.getElement());this.qa(this.Qd);this.getHandler().listen(this.Ez,"action",this.LLb).listen(this.Qd,"key",this.MLb)};r.LLb=function(){this.Ez.HP();this.Ez.zf().Pa()||this.dispatchEvent("Nh")};
r.MLb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Nh"));break;case 37:a.preventDefault();this.dispatchEvent("Oh");break;case 39:a.preventDefault(),this.dispatchEvent("Ph")}};r.toString=function(){return this.Ez.zf().Pa()+this.eC.toString()};r.setValue=function(a){this.Ez.setValue(a)};function Saf(a){P.call(this);this.bf=a||""}u(Saf,P);r=Saf.prototype;
r.Aa=function(){var a=Uu("SPAN");Ru(a,{contentEditable:!0});jv(a,this.bf);var b=a.style;C.Eb&&!C.Uc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=C.vd?"-moz-pre-wrap":"pre-wrap";this.sb(a)};r.Ga=function(){P.prototype.Ga.call(this);var a=new jx(this.getElement());this.qa(a);this.getHandler().listen(a,"key",this.NLb).listen(this.getElement(),"paste",this.OLb)};
function fbf(a,b){if(0==mv(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=eP(c,b);a.getElement().focus();b.select()}}
r.NLb=function(a){var b=lv(this.getElement()),c=ZO(),d=mv(this.getElement()).length,e=c?0==c.wl()&&0==c.So():zd(df(b));b=c?c.wl()==d&&c.So()==d:zd(df(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Kh"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Nh"));break;case 40:this.dispatchEvent("Lh");break;case 38:this.dispatchEvent("Mh");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("Qh"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Rh"));break;
case 13:a.preventDefault()}};r.toString=function(){var a=$fa(mv(this.getElement())).replace(/"/g,'"\\""');return 0==df(a).length?"":'"'+a+'"'};r.OLb=function(){var a=v(function(){jv(this.getElement(),mv(this.getElement()))},this);zn(a)};function gbf(a){E5.call(this,a);this.setTitle("Custom date and time formats")}u(gbf,E5);r=gbf.prototype;r.xTa=n(!1);r.wZ=n(11175.5628472222);r.isEmpty=function(){return zd(Yf(this.t1(),2))};r.tf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Yf(this.t1(),2))};r.Jha=function(){return new Raf("Custom date time format",11175.5628472222)};r.t1=function(){return hbf(this.input.getValue())};
r.S7=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.wZ(),c.Pl());c.D=d}b=ibf(this);kd(b);for(c=0;c<b.length;c++)a.push(new IW(hbf(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.wZ(),b[c])));return a};
function ibf(a){var b=DB,c=Rc(b.DATEFORMATS,function(h){return jbf(h)},a),d=Rc(b.TIMEFORMATS,function(h){return jbf(h)},a),e=c.concat(d);b=b.DATETIMEFORMATS;kd(b);a=Rc(b,function(h){return jbf(h)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function jbf(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ad(a.join(""))}function hbf(a){var b=new ag;b.setType(7);I(b,3,1);I(b,2,a);return b};function kbf(){var a='<div class="'+W("waffle-sdsd-source-container")+'"><div class="'+W("waffle-sdsd-rangepicker-container")+'"><div class="'+W("waffle-sdsd-rangepicker-label")+'">';a=a+"Data range"+('</div><div class="'+W("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+W("waffle-sdsd-rangepicker-error-label")+'"></div></div></div><div class="'+W("waffle-sdsd-destination-radio-container")+'"><div id="insertOptionHeader" class="'+W("waffle-sdsd-rangepicker-label")+'">');
a=a+"Insert to"+('</div><div class="'+W("waffle-sdsd-destination-selection")+'" role="radiogroup" aria-labelledby="insertOptionHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET" checked="checked">');a=a+'New sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="EXISTING_SHEET">Existing sheet'+('</label></div></div></div><div style="display: none;" class="'+W("waffle-sdsd-destination-container")+'"><div class="'+
W("waffle-sdsd-rangepicker-container")+'"><div class="'+W("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+W("waffle-sdsd-rangepicker-error-label")+'"></div></div></div>');return V(a)};function lbf(a,b,c,d,e,f,h,k){ZT.call(this,void 0,k,!0,B(A(),"docs-egmd"));this.pe=c;this.va=d;this.V=e;this.ea=h;this.R=new j1d;this.L=a;this.Fa(this.L);this.J=b;this.Fa(this.J);this.O=null;this.setTitle(f);Sz(this,!1)}u(lbf,ZT);r=lbf.prototype;
r.Aa=function(){ZT.prototype.Aa.call(this);Q(this.Ma(),"waffle-source-destination-selection-dialog");var a=this.Fb(),b=this.oa(),c=R(kbf);b.appendChild(a,c);this.C.setContent("Create");c=b.Ea("waffle-sdsd-range-selection",mbf(this));nbf(this.L,c);c=b.Ea("waffle-sdsd-range-selection",obf(this));nbf(this.J,c);k1d(this.R,"destination",a);b.Ea("waffle-sdsd-rangepicker-label",this.Fb()).id="waffle-sdsd-rangepicker-label-id"};
r.Ga=function(){ZT.prototype.Ga.call(this);this.ea&&this.L.setValue(this.ea);this.getHandler().listen(this,"od",this.DLb).listen(this.R,"Ld Md Nd Od action select".split(" "),this.ELb).listen(this.J,"change",this.SGa).listen(this.L,"change",this.iJa).listen(this.J,"activate",this.AHa).listen(this.L,"activate",this.AHa);Xm(Oz(this),"click",this.V)};r.AHa=function(a){this.O=a.target.hba()};r.SGa=function(){pbf(this,obf(this),this.J.P3("Please enter a valid destination."));this.J.focus()};
r.DLb=function(){this.va();this.V()};r.iJa=function(){pbf(this,mbf(this),this.L.P3("Please enter a valid range."));this.L.focus()};function qbf(a){return"EXISTING_SHEET"===n1d(a.R)}function pbf(a,b,c){var d=!!c;a=a.oa().Ea("waffle-sdsd-rangepicker-error-label",b);N(a,d);d&&(jv(a,c),TK(c))}function mbf(a){return a.oa().Ea("waffle-sdsd-source-container",a.Fb())}function obf(a){return a.oa().Ea("waffle-sdsd-destination-container",a.Fb())}
r.qB=function(){qbf(this)&&this.SGa();this.iJa();if(!(this.L.P3("error")||qbf(this)&&this.J.P3("error"))){var a=this.L.Hka(),b=this.J.Hka();ZT.prototype.qB.call(this);this.pe(a,b?new CH(b.C,b.rect.top,b.rect.left):void 0);this.dispose();this.V()}};r.ELb=function(){var a=qbf(this);N(obf(this),a);a&&(a=this.J.hba())&&a.focus()};function nbf(a,b){a.render(b);(a=a.hba())&&ex(a,"labelledby","waffle-sdsd-rangepicker-label-id")}r.show=function(){this.setVisible(!0)};
r.setVisible=function(a){ZT.prototype.setVisible.call(this,a);a&&this.O&&(this.O.focus(),this.O=null)};function rbf(){P.apply(this,arguments)}u(rbf,P);function sbf(a,b,c,d,e){rbf.call(this,e);this.F=a;this.D=c;this.C=new HV(b,v(this.CLb,this),d,d?"e.g. Sheet1!F10":"eg. Sheet1!A1:D100",!0,void 0,this.oa(),End.getInstance());this.C.V=!1;this.Fa(this.C,!0)}u(sbf,rbf);r=sbf.prototype;r.hba=function(){return this.C.Os()};r.getValue=function(){return this.C.getValue()};r.setValue=function(a){this.C.setValue(a)};
r.Hka=function(){return TN(this.getValue(),this.F.C,!1,!0)};r.P3=function(a){var b=this.getValue();if(!b)return a;b=T8b(b,this.F.C,!1,!0);return b instanceof fm?null:"range-datasource-sheet"===b?"Range can't reference connected sheets.":a};r.focus=function(){this.C.focus()};r.CLb=function(a,b,c,d){this.dispatchEvent("activate");c&&this.D.setTitle("What location?");var e=null;this.getParent()instanceof ZT&&(e=this.getParent());this.D.rf(e,a,b,c,!1,!0,d)};function tbf(a,b,c){rbf.call(this,c);this.C=a;this.D=b}u(tbf,rbf);r=tbf.prototype;r.Aa=function(){rbf.prototype.Aa.call(this);this.sb(this.oa().Aa("DIV",{style:"padding: 10px 0"},this.D))};r.hba=function(){return this.getElement()};r.getValue=n("");r.setValue=ba();r.Hka=function(){return new fm(this.C,null)};r.P3=n(null);r.focus=ba();function ubf(a,b,c,d,e){E.call(this);this.H=null;this.C=a;this.D=b;this.J=c;this.O=d;this.F=e;this.L=new cn(this);this.qa(this.L);this.L.listen(a,"replaceall",this.kwb).listen(a,"replace",this.lwb).listen(a,"findnext",this.DVa).listen(a,"done",this.Tkb)}x(ubf,E);r=ubf.prototype;r.p_b=function(){this.C.setVisible(!0);vbf(this,null)};r.DVa=function(a){if(dL(this.D)){var b=cL(this.D).Pa(),c=this.H;if(!c){c=gK(b);var d={};c=(d.cg=b.qc(),d.cr=b.uZ(c.y),d.cc=b.sD(c.x),d)}wbf(this,a,b,c)}};
function wbf(a,b,c,d){var e=new Xj,f=xbf(b);ybf(f,c,d);a.F.Ub.dispatchEvent(null);c=e.serialize(f);d=v(function(h){var k=e.Tc(JBb.xa(),h);h=H(f,1);var l=b.type;if(dL(this.D))if(k)if(Tf(k,1)){l=H(k,1);var m={};k=(m.cg=l.xb(),m.cr=l.Yk(),m.cc=l.getColumnIndex(),m.loop=H(k,2),m);zbf(this,h,k)}else zbf(this,h,{}),"replace"==l&&this.C.focus();else Abf(this)},a);ritz_api.RitzModelApi.findNext(c,d);I(f,14,1);a.F.Vb.dispatchEvent(new W9e("find-next-occurrence",f))}
function ybf(a,b,c){if(c){var d=c.cg,e=new zh;I(e,1,d);I(e,2,O9e(b,c.cr,"r"));I(e,3,O9e(b,c.cc,"c"));I(a,10,e)}}function xbf(a){var b=new CG;I(b,1,a.D);I(b,3,a.F);I(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ha,d=new jg;I(d,1,c.C);var e=c.rect.Ac();I(d,2,e);kg(d,c.rect.Zc());lg(d,c.rect.xc());mg(d,c.rect.cd());b.setSelection(d)}I(b,6,a.H||!1);I(b,7,a.L||!1);I(b,8,a.ea||!1);b.setType(a.va?1:0);I(b,11,0);return b}
function zbf(a,b,c){c?c&&null!=c.cg?(b=c.cg,c.loop&&A5(a.C,"No more results found, looping around"),a.J.wC(b,v(a.S1b,a,c))):(vbf(a,null),A5(a.C,"There are no entries matching "+b)):Abf(a)}r.S1b=function(a){var b=cL(this.D).Pa(),c=a.cr,d=a.cc;a.cr=b.uZ(c);a.cc=b.sD(d);vbf(this,a);a=new ul(d,c);b=new fm(b.qc(),Rl(a));FY(this.J,b,v(this.H_a,this,a))};
r.H_a=function(a){if(!this.isDisposed()){this.C.focus();var b=cL(this.D).Pa();wJ(b.wh(a.y,a.x))&&!this.C.J.isChecked()&&e$e(this.C,!1,"Can't replace formula");var c=b.bt(a.y),d=b.WA(a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=UN(a),a=xJ(rJ(b,a)),A5(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function Abf(a){A5(a.C,null);A5(a.C,"Error while searching spreadsheet. Please try again.")}
r.lwb=function(a){if(!this.F.Id()){var b=this.H;if(b){var c=oJ(this.J,b.cg);if(c){var d=c.Cc(),e=O9e(d,b.cr,"r"),f=O9e(d,b.cc,"c");c=d.wh(e,f);if(!wJ(c)||this.C.J.isChecked()){c=xJ(c);var h=new Xj,k=xbf(a);I(k,5,0);ybf(k,d,b);d=new jg;I(d,1,b.cg);I(d,2,e);kg(d,e+1);lg(d,f);mg(d,f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);Bbf(this,k,c,b,!1);this.F.Vb.dispatchEvent(new W9e("replace-current-occurrence",k));this.DVa(a)}}}}};
r.kwb=function(a){if(!this.F.Id()&&dL(this.D)){var b=xbf(a);Bbf(this,b,a.D,a.F,!0)}};
function Bbf(a,b,c,d,e){b=new o1d(b);WK(b,v(function(f,h){f?(f=H(h,5),h=H(h,4),h=0==f?"No matches found":e?(new IA(1==h?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:f,NUM_SHEETS:h,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),A5(this.C,null),A5(this.C,h)):Abf(this)},a));A5(a.C,null);A5(a.C,"Working...");a.O.C(b)}r.Tkb=function(){vbf(this,null)};function vbf(a,b){a.H=b;(a=a.C)&&e$e(a,null!=b)};function Cbf(a,b){ZT.call(this);this.setTitle("Grouping rule");this.V=a;this.R=new P;this.Fa(this.R,!0);this.J=new Dbf("Minimum value","e.g. 0",!0);this.R.Fa(this.J,!0);this.O=new Dbf("Maximum value","e.g. 100",!0);this.R.Fa(this.O,!0);this.L=new Dbf("Interval size","e.g. 10",!1);this.Fa(this.L,!0);a=b.tj();null!=a&&this.J.D.setValue(JQ.format(a));a=b.ct();null!=a&&this.L.D.setValue(JQ.format(a));b=b.Oo();null!=b&&this.O.D.setValue(JQ.format(b))}u(Cbf,ZT);
Cbf.prototype.qB=function(){var a=Ebf(this.J),b=Ebf(this.L),c=Ebf(this.O);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(Fbf(this.L,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(Fbf(this.J,"Value too large"),d=!1):d=!0;d&&(this.V.Gb(new exd(a,b,c)),ZT.prototype.qB.call(this))};
function Dbf(a,b,c,d){P.call(this,d);this.L=a;this.O=b;this.R=c;this.J=new P;this.Fa(this.J,!0);this.D=new vZ;this.Fa(this.D,!0);this.H=null;this.C=new P;this.Fa(this.C,!0);this.F=new cW(this.oa(),!0,!0);this.qa(this.F)}u(Dbf,P);
Dbf.prototype.Ga=function(){P.prototype.Ga.call(this);this.Ma().className="waffle-pivot-histogram-errorable-input";this.J.Ma().className="waffle-pivot-histogram-dialog-caption";this.oa().we(this.J.getElement(),this.L);this.H=this.D.Cd().hO(this.D.Ma());this.H.placeholder=this.O;hx(this.H,this.L+" - "+this.O);fW(this.F,this.H);this.C.Ma().className="waffle-pivot-histogram-dialog-error";dx(this.C.Ma(),"alert");ex(this.C.Ma(),"live","polite");Gbf(this)};
function Ebf(a){Gbf(a);var b=a.D.getValue();if(zd(b)){if(a.R)return null;Fbf(a,"Required");return NaN}b=JQ.parse(b);isNaN(b)&&Fbf(a,"Must be a number");return b}function Fbf(a,b){a.C.Ma().style.visibility="";a.oa().we(a.C.Ma(),b);dW(a.F,b,!1)}function Gbf(a){a.C.Ma().style.visibility="hidden";eW(a.F)};function Hbf(a,b){this.D=a;this.C=b}Hbf.prototype.getUrl=g("D");Hbf.prototype.getTitle=g("C");function Ibf(a,b,c,d,e,f){s$a.call(this,a,b,"domain",d,e,f);this.F=c}x(Ibf,s$a);Ibf.prototype.kX=function(){var a=Ibf.Ia.kX.call(this);a.domainName=this.F;return Hd(a,B3a)};u$a.set("domain",function(a){return new Ibf(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new Ibf("","DEFAULT","",!0);function Jbf(){};function L5(a,b,c,d){this.Tca=a;this.D=b;this.C=c;this.fDb=d;this.F=Kbf++}var Kbf=0;L5.prototype.ej=g("F");L5.prototype.getName=g("D");L5.prototype.getLabel=g("C");function Lbf(a){var b=a.YXb,c="";a=a.vSa;for(var d=a.length,e=0;e<d;e++){var f=a[e],h=b[f.ej()],k=f.getLabel();f=f.fDb;f=V('<div id="'+W(h)+'" tabindex="0" role="link" class="'+W("ess-button")+'" aria-label="'+W(k)+'"><div class="'+W("ess-icon")+" "+W(f)+'"></div></div>');c+=f}return V(c)};function Mbf(a,b){P.call(this,b);this.D=a||[];this.F=[];this.C=null}x(Mbf,P);r=Mbf.prototype;r.Pd=!0;r.Yfa=!1;r.WQ=null;r.OAa=!1;r.Na=function(a,b){this.Pd=a;this.Yfa=b;if(this.OAa){b=this.oa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.WQ.Nsa+"-"+d.ej()),f=a;ux(e,"ess-button",f);ux(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();ry(e,f,d)}}};
r.Aa=function(){this.sb(this.$a.createElement("SPAN"));var a={};a.Nsa=Sw(this,"service");a.vSa=this.D;this.WQ=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.ej()]=this.WQ.Nsa+"-"+d.ej();a.YXb=b;this.WQ=a;Oy(this.getElement(),Lbf,this.WQ);this.OAa=!0};
r.SVb=function(a){if(this.Pd){if(this.C){var b={};b.externalSharingService=a.Tca;this.C.C(9,b)}if(this.Yfa)this.dispatchEvent(new Nbf(new Obf(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.Tca;c.C(10,d)}a={dEc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Ww(b,a))&&a.focus()}}};
r.Ga=function(){this.Na(this.Pd,this.Yfa);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.WQ.Nsa+"-"+d.ej());b.Cg(e,Zm,v(this.SVb,this,d))}};r.Ja=function(){Mbf.Ia.Ja.call(this);delete this.F;delete this.D;this.C=null};function Nbf(a,b){Rm.call(this,"Sh",b);this.context=a}x(Nbf,Rm);function Obf(){}x(Obf,Jbf);function Pbf(){L5.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(Pbf,L5);Pbf.prototype.getUrl=function(a){var b=Rc(a,function(c){return c.getTitle()});a=Rc(a,function(c){return c.getUrl()});return"http://www.facebook.com/share.php?u="+We(a.join(","))+"&t="+We(b.join(","))};function Qbf(){L5.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(Qbf,L5);Qbf.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+We(a[0].getUrl())};function Rbf(){L5.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(Rbf,L5);Rbf.prototype.getUrl=function(a){a=Rc(a,function(b){return b.getTitle()+" - "+b.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+We(a.join("\n"))};function Sbf(){L5.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(Sbf,L5);Sbf.prototype.getUrl=function(a){for(var b=ua(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+We(a)};function Tbf(a){P.call(this,a)}x(Tbf,P);function Ubf(a){a.dispatchEvent(new Rm("Th"))}Tbf.prototype.EZ=function(){return{}};Tbf.prototype.rM=ee;Tbf.prototype.Hsa=xa;function Vbf(a){P.call(this,a)}x(Vbf,P);Vbf.prototype.F=ee;Vbf.prototype.H=xa;Vbf.prototype.J=xa;function Wbf(a,b,c){b=c||b;c=a.QVb;var d=a.RVb,e=a.Q4a,f=a.x9a,h=a.hUb,k='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';a="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+V9e(a.locale)+'&answer=183965">Learn more</a>');
k=k+a+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';k+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';k+="Embed";k+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
W(e)+'" readonly="readonly" aria-label="';k+=cz("Link to published document.");k+=" "+W(h)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';k+="Or share this link using:";k+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';
k+=cz("HTML embed code of published document.");k+=" "+W(h)+'">'+u2a(f)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+U(zz({id:"pub-dialog-publish-link-button",style:2,value:d},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+U(kB({Xm:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));k+="Published content and settings";k+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
U(zz({id:"pub-dialog-publish-button",value:c},b))+'<div class="pub-dialog-checkbox-container"></div></div></div></div></div>';return V(k)};function M5(a,b,c,d,e,f,h,k,l,m){cB.call(this);this.Ya=a||"";this.Vd=b;this.Vc=c;this.Pc=d;this.Ec=l||"/publishsettings";this.C=new Xbf(e);this.Cb=new Mbf([new Qbf,new Rbf,new Pbf,new Sbf]);this.Fa(this.Cb);this.bb=B(A(),"docs-egmd");this.va=new Az(null,this.oa());this.Fa(this.va);this.ea=new Az(null,this.oa());this.Fa(this.ea);this.L=this.bb?new VW(void 0,UW.getInstance(),this.oa()):new nT(void 0,this.oa());this.Fa(this.L);this.O=this.bb?new VW(void 0,UW.getInstance(),this.oa()):new nT(void 0,this.oa());
this.Fa(this.O);this.Ta=0;this.Ub=new Ybf;this.Fa(this.Ub);this.yb=this.Jb=null;this.J=f||new Tbf;this.Fa(this.J);this.F=h||new Tbf;this.Fa(this.F);this.Sa=k||new Vbf;this.Fa(this.Sa);this.V=this.R=null;this.Ha=new m$a(void 0,Zbf,this.oa(),2);this.qa(this.Ha);this.cb=this.ud=null;this.Ce=m||new P;this.kc=this.Xa=this.Vb=null;this.Ri=!0}x(M5,cB);var Zbf="Press "+((C.jf?"\u2318+C":"Ctrl+C")+" to copy.");r=M5.prototype;r.dd=function(){M5.Ia.dd.call(this);this.Ha.dd()};
r.show=function(){$bf(this,v(function(){this.setVisible(!0)},this))};r.setVisible=function(a){M5.Ia.setVisible.call(this,a);var b=sv(this.oa());a?this.getHandler().listen(b,"resize",this.dd):this.getHandler().Hc(b,"resize",this.dd)};
r.Aa=function(){M5.Ia.Aa.call(this);var a=this.oa(),b=R(Wbf,{QVb:acf(this),RVb:bcf(this,ccf(this))?"Published":"Publish",Q4a:this.C.bl?dcf(this,this.J.EZ()):"",x9a:this.C.bl?ecf(this,this.F.EZ()):"",locale:"en-GB",hUb:Zbf});a.appendChild(this.Fb(),b);this.setTitle("Publish to the web");Wz(this,null);Q(this.Fb(),"pub-dialog-content")};function fcf(a){return"Require viewers to sign in with their "+(a.C.F+" account")}
r.Ga=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.Cb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Vb=a.getElement("pub-dialog-links-notice");this.Ce.render(this.Vb);b=a.getElement("pub-dialog-published-content");this.Sa.render(b);M5.Ia.Ga.call(this);b=this.getHandler();var c=this.Ea("pub-dialog-checkbox-container");if(this.C.domain){this.L.ye("pub-dialog-dom-signin-req");
this.L.render(c);this.L.gc(this.C.Sx);if(this.bb)this.L.setContent(fcf(this));else{var d=Uu("LABEL",void 0,fcf(this));Zu(c,d);kT(this.L,d);Zu(c,Wu("BR"))}b.listen(this.L,"change",this.c0b)}this.C.C&&(this.O.ye("pub-dialog-auto-publish-checkbox"),this.O.render(c),this.bb?this.O.setContent("Automatically republish when changes are made"):(d=Uu("LABEL",void 0,"Automatically republish when changes are made"),Zu(c,d),kT(this.O,d)),b.listen(this.O,"change",this.Z_b));this.Jb=a.getElement("pub-dialog-link-tab-content");
this.R=a.getElement("pub-dialog-document-link");this.yb=a.getElement("pub-dialog-embed-tab-content");this.V=a.getElement("pub-dialog-embed-code");rB(this.Ha,this.R);this.Ub.Va(a.getElement("pub-dialog-links-tab-bar"));this.ud=a.getElement("pub-dialog-sharing-services");this.cb=a.getElement("pub-dialog-status-info");this.va.Va(a.getElement("pub-dialog-publish-link-button"));this.ea.Va(a.getElement("pub-dialog-publish-button"));this.kc=new LO("pub-dialog-settings-header","pub-dialog-settings-content",
this.C.bl);this.qa(this.kc);b.listen(this.Ub,"select",this.pxb).listen(this.R,"focus",this.hSa).listen(this.V,"focus",this.hSa).listen(this.ea,"action",this.TVb).listen(this.getElement(),"keyup",this.t4a).listen(this.J,"Th",this.Hua).listen(this.F,"Th",this.Hua).listen(this.va,"action",this.fvb).listen(this.Sa,"Uh",this.gvb).listen(this.kc,"toggle",this.dd);gcf(this)};
function gcf(a){if(a.Db()){var b=a.oa(),c=a.C.bl,d=a.C.D;a.Sa.H(a.C.Ao);a.L.Na(!d);a.ea.setContent(acf(a));a.ea.Na(a.C.bl||!a.C.Ao||!a.C.Ao.isEmpty());a.C.C&&a.O.gc(a.C.vy);a.Hua();b=b.Li("pub-dialog-state-publishing");Nc(b,function(e){N(e,c)});jv(a.cb,a.C.bl?"This document is published to the web.":"This document is not published to the web.");a.C.bl?Q(a.cb,"pub-dialog-state-published"):sx(a.cb,"pub-dialog-state-published");a.dd()}}r.t4a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function hcf(a,b){var c=window.location.href,d=Kk(c);c=Nk(c);var e=Bd(c,"/"+a.Pc+"/")?"/"+a.Pc:"";a.C.Sx&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.H||a.Ya;b=oEa.test(b)?b:Xk("/d/"+a,b);return $sa(c,f,h,d,Xk(e,b))}
r.Hua=function(){var a=this.J.rM();if(a=bcf(this,a)){var b=this.C.bl?dcf(this,this.J.EZ()):"";this.R.value=b;this.Cb.F=[new Hbf(b,this.Vd)]}N(this.R,a);N(this.ud,a&&!this.C.D);a=this.F.rM();if(a=bcf(this,a))this.V.value=this.C.bl?ecf(this,this.F.EZ()):"";N(this.V,a);a=bcf(this,ccf(this));N(this.Vb,a);this.va.Na(!a);this.va.setContent(bcf(this,ccf(this))?"Published":"Publish")};
r.pxb=function(a){a=a.target;this.oa();d$a(this.Ha);"pub-dialog-link-tab"==a.getId()?(this.Ta=0,N(this.Jb,!0),N(this.yb,!1),rB(this.Ha,this.R)):"pub-dialog-embed-tab"==a.getId()&&(this.Ta=1,N(this.Jb,!1),N(this.yb,!0),rB(this.Ha,this.V));gcf(this)};r.hSa=function(a){zn(function(){a.target.select()},0)};r.c0b=function(){this.C.bl?icf(this,2,!1):this.C.Sx=!this.C.Sx};r.Z_b=function(){this.C.bl?icf(this,0,!1):this.C.vy=!this.C.vy};function acf(a){return a.C.bl?"Stop publishing":"Start publishing"}
function $bf(a,b){lk(hk(a.Vc.mf(a.Ec),"id",a.Ya),v(function(c){this.C.bl=!!aL(c,"published");this.C.Sx=!!aL(c,"requireSignin");this.C.D=!!aL(c,"domainClosed");this.C.domain=mQd(c,"domain");this.C.F=mQd(c,"domainDisplay");this.C.vy=!Number(aL(c,"revision"));this.C.Ao=this.kEa(c.We());this.C.H=mQd(c,"publishedDocumentId");b()},a)).$e()}r.kEa=ee;r.ODa=ee;function jcf(a){return{vy:a.C.vy,bl:a.C.bl,Sx:a.C.Sx,Ao:a.C.Ao}}
function icf(a,b,c){c=ra(c)?c:!0;var d=jcf(a);switch(b){case 0:d.vy=!d.vy;break;case 1:d.bl=!d.bl;break;case 2:d.Sx=!d.Sx;break;default:throw Error("Unknown toggle op: "+b);}d.bl||(d.Ao=a.ODa());kcf(a,d,c)}
function kcf(a,b,c){lcf(a,!1);kk(lk(ik(Fo(hk(a.Vc.mf(a.Ec),"id",a.Ya),mcf(a,b)),2),v(function(){this.C.vy=b.vy;this.C.bl=b.bl;this.C.Sx=b.Sx;this.C.Ao=b.Ao;this.C.bl&&this.C.Ao&&(bcf(this,this.J.rM())||this.J.Hsa(this.C.Ao),bcf(this,this.F.rM())||this.F.Hsa(this.C.Ao));lcf(this,!0);gcf(this);if(c&&this.C.bl)switch(this.Ta){case 0:this.R.focus();this.R.select();break;case 1:this.V.focus();this.V.select();break;default:throw Error("Cannot handle selected link type "+this.Ta);}},a)),v(function(){q_b("An error occurred whilst saving publishing settings.",
void 0,this.Db()?this:void 0);lcf(this,!0);gcf(this)},a)).$e()}function mcf(a,b){var c={id:a.Ya,requireSignin:b.Sx,published:b.bl};a.C.C&&!b.vy&&(c.revision=a.C.C);b.Ao&&(a=ncf(b.Ao),Yd(c,a));return c}function lcf(a,b){for(var c=[a.O,a.ea,a.va,a.L],d=0;d<c.length;d++){var e=c[d];!b&&e.wk()&&(a.Xa=e);e.Na(b)}b&&a.Xa&&(a.isVisible()&&a.Xa.isVisible()&&(c=a.Xa.getElement())&&c.focus(),a.Xa=null);a.Sa.J(b)}
r.TVb=function(a,b){if(b||window.confirm(this.C.bl?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ea.setContent("Saving..."),icf(this,1)};function ccf(a){switch(a.Ta){case 0:return a.J.rM();case 1:return a.F.rM();default:throw Error("Cannot handle selected link type "+a.Ta);}}
r.fvb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=ccf(this),b=jcf(this);b.bl=!0;a&&(b.Ao&&this.C.bl?b.Ao=ocf(b.Ao,a):b.Ao=a);this.va.setContent("Publishing...");kcf(this,b,!0)}};r.gvb=function(){var a=this.Sa.F();if(this.C.bl)if(a&&a.isEmpty())icf(this,1);else{var b=jcf(this);b.Ao=a;kcf(this,b)}else this.C.Ao=a,gcf(this)};function bcf(a,b){var c;(c=a.C.bl)&&!(c=!b||!a.C.Ao)&&(a=a.C.Ao,c=a.F||!b.F&&Uc(b.D.Jd(),a.S$,a)&&Uc(b.C,a.C$,a));return c}
function Xbf(a){this.C=a;this.D=this.Sx=this.bl=!1;this.vy=!0;this.H=this.F=this.domain=""}function Ybf(){vU.call(this)}x(Ybf,vU);Ybf.prototype.Ye=function(a){return a.keyCode&&27==a.keyCode?!1:Ybf.Ia.Ye.call(this,a)};function pcf(a,b,c,d){this.F=a;this.gi=b;this.C=c;this.D=d}function qcf(a,b){return new pcf(!1,null,new rcf(a,b||"interactive"),null)}function rcf(a,b){this.id=a;this.format=b};function N5(a,b,c){this.F=a;this.D=new nJ(b);this.C=c}r=N5.prototype;r.S$=function(a){return this.F||this.D.contains(a)};function scf(a,b){return Tc(a.C,function(c){return c.id==b.id})}r.C$=function(a){return this.F||this.D.contains(a.gi)||scf(this,a)};function tcf(a,b){a.C=Qc(a.C,function(c){return c.gi!=b})}function ucf(a,b){scf(a,b)&&(a.C=Qc(a.C,function(c){return c.id!=b.id}))}
function ocf(a,b){var c=a.F||b.F;if(c)return new N5(c,[],[]);var d=a.clone();Nc(b.D.Jd(),function(e){d.D.contains(e)||(d.D.add(e),tcf(d,e))});Nc(b.C,function(e){d.C$(e)||d.C.push(e)});return d}function ncf(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Jd().join(","),charts:Rc(a.C,function(b){return b.id}).join(",")}}r.isEmpty=function(){return!this.F&&this.D.isEmpty()&&Zc(this.C)};r.clone=function(){return new N5(this.F,this.D.Jd(),hd(this.C))};
r.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&qd(this.C,a.C,function(b,c){return b.id==c.id&&b.gi==c.gi})};function vcf(a,b){this.id=a;this.gi=b};function wcf(a,b,c,d){P.call(this,void 0);this.C=c||new pcf(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new pR("",xcf(a,b));this.D.Vj(!0);this.Fa(this.D,!0);a=new cy;a.Fa(new Yx("Interactive","interactive"),!0);a.Fa(new Yx("Image","image"),!0);this.H=new pR("",a);this.Fa(this.H,!0);a=new cy;a.Fa(new Yx("Web page","html"),!0);a.Fa(new Yx("Comma-separated values (.csv)","csv"),!0);a.Fa(new Yx("Tab-separated values (.tsv)","tsv"),!0);a.Fa(new Yx("PDF document (.pdf)","pdf"),!0);a.Fa(new Yx("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Fa(new Yx("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new pR("",a);this.Fa(this.F,!0);ycf(this)}x(wcf,Tbf);var zcf=["xlsx","ods"],Acf=["csv","tsv"];
function xcf(a,b){var c=new cy;c.Fa(new Yx("Entire Document",new Bcf("entireDocument",null)),!0);c.Fa(new by,!0);var d=N9b(b);Nc(a.D,function(e){c.Fa(new Yx(e.Yd(),new Bcf("sheet",e.xb())),!0);if(e=d[e.xb()])for(var f={},h=0;h<e.length;f={kW:f.kW},h++){var k=e[h];6==k.getType()&&k.isSaved()&&(f.kW=new Yx("",new Bcf("chart",kL(k))),dO(k).then(function(l){return function(m){l.kW.Uj(m.getTitle())}}(f)),c.Fa(f.kW,!0),Q(f.kW.Fb(),"pub-dialog-link-options-chart-menu-item"))}});return c}r=wcf.prototype;
r.Ga=function(){wcf.Ia.Ga.call(this);Q(this.getElement(),"pub-dialog-link-options-container");Q(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Q(this.D.Fb(),"pub-dialog-link-options-document-part-menu-button-content");Q(this.D.Tb().getElement(),"pub-dialog-link-options-document-part-menu");hx(this.D.Ma(),"Sheet or chart selection");hx(this.H.Ma(),"Chart format");hx(this.F.Ma(),"Sheet format");this.getHandler().listen(this.D,"change",this.Nkb).listen(this.H,"change",this.vhb).listen(this.F,
"change",this.Zxb).listen(this.D,"afterhide",function(a){a.stopPropagation()}).listen(this.H,"afterhide",function(a){a.stopPropagation()}).listen(this.F,"afterhide",function(a){a.stopPropagation()})};
r.Nkb=function(){var a=this.D.zf().Pa();switch(a.type){case "entireDocument":this.C=new pcf(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!Ccf(this,a,b)&&(b=null);this.C=new pcf(!1,a,null,b||"html");break;case "chart":this.C=qcf(a.id,this.C.C?this.C.C.format:null)}ycf(this);Ubf(this)};r.vhb=function(){var a=this.H.zf().Pa();this.C.C&&(this.C.C.format=a,Ubf(this))};r.Zxb=function(){var a=this.F.zf().Pa();this.C.D=a;Ubf(this)};
function ycf(a){var b=hd(a.D.Oj.C);b=Vc(b,function(c){c=c.Pa();if(!c)return!1;switch(c.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.gi&&c.id==this.C.gi;case "chart":return null!=this.C.C&&c.id==this.C.C.id;default:return!1}},a);By(a.D,b);b=!!a.C.C;N(a.H.getElement(),b);null!=a.C.C&&a.H.setValue(a.C.C.format);N(a.F.getElement(),a.J&&!b);b||(Dcf(a),a.F.setValue(a.C.D))}
function Dcf(a){for(var b=a.F.Tb(),c=0;c<b.oi();c++){var d=b.Jf(c),e=d.getValue();d.Na(null==a.C.gi||Ccf(a,a.C.gi,e))}}function Ccf(a,b,c){if(Xc(zcf,c))return!1;a=tM(a.O,b);return null!=a&&1==a.getSheetType()&&Xc(Acf,c)?!1:!0}r.EZ=g("C");r.rM=function(){if(this.C.F)return new N5(!0,[],[]);if(null!=this.C.gi)return new N5(!1,[this.C.gi],[]);var a=this.L.C(this.C.C.id);a=new vcf(this.C.C.id,a.xb());return new N5(!1,[],[a])};
r.Hsa=function(a){if(!a.F){var b=a.D.Jd();0<b.length?this.C=new pcf(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=qcf(a[0].id)));ycf(this)}};function Bcf(a,b){this.type=a;this.id=b};function Ecf(a,b){pR.call(this,void 0,void 0);this.R=a;this.O=b;this.C=new N5(!0,[],[]);this.L=!1;this.D=new gW("Entire Document");this.Qc(this.D);this.Qc(new by);Fcf(this);this.Vj(!0);Gcf(this)}x(Ecf,pR);function Fcf(a){var b=N9b(a.O);Nc(a.R.D,function(c){var d=new gW(c.Yd(),c);a.Qc(d);(c=b[c.xb()])&&Nc(c,function(e){if(6==e.getType()&&e.isSaved()){var f=new gW("",e);dO(e).then(function(h){f.Uj(h.getTitle())});a.Qc(f);Q(f.Fb(),"pub-dialog-published-content-chart-menu-item")}})})}
Ecf.prototype.Ga=function(){Ecf.Ia.Ga.call(this);Q(this.getElement(),"pub-dialog-published-content-menu-button");Q(this.Fb(),"pub-dialog-published-content-menu-button-content");Q(this.Tb().getElement(),"pub-dialog-published-content-menu");this.getHandler().listen(this,"afterhide",function(a){a.stopPropagation()})};
Ecf.prototype.Vv=function(a){if(a.target==this.D){a=this.D.isChecked();var b=this.C;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Pa(),b instanceof yH?(b=b.xb(),a?(a=this.C,a.D.contains(b)||(a.D.add(b),tcf(a,b))):(a=this.C,a.D.contains(b)&&(a.D.remove(b),tcf(a,b)))):(b=new vcf(kL(b),b.xb()),a?(a=this.C,a.C$(b)||a.C.push(b)):ucf(this.C,b));this.L=!0;Gcf(this)};Ecf.prototype.Fd=function(a,b){Ecf.Ia.Fd.call(this,a,b);!a&&this.L&&(this.L=!1,this.dispatchEvent(new Rm("Uh")))};
function Gcf(a){var b=a.C.F;a.D.gc(b);Nc(E0a(a.Tb()),function(c){var d=c.Pa();d&&(d instanceof yH?(c.gc(a.C.S$(d.xb())),c.Na(!b)):(d=new vcf(kL(d),d.xb()),c.gc(a.C.C$(d)),c.Na(!a.C.S$(d.gi))))});Hcf(a)}
function Hcf(a){if(a.C.F)a.setContent("Entire Document");else{var b=Qc(a.R.D,v(function(h){return this.C.S$(h.xb())},a)),c=Rc(b,function(h){return h.Yd()});b=[];for(var d=a.C.C,e=0;e<d.length;e++){var f=a.O.C(d[e].id);f&&b.push(dO(f))}rn(b).then(function(h){for(var k=[],l=0;l<h.length;l++){var m=h[l];m.pR&&k.push(m.value.getTitle())}h=gd(c,k);h=0<h.length?h.join(", "):"None";a.setContent(h)})}};function Icf(a,b){P.call(this,void 0);this.C=new Ecf(a,b);this.Fa(this.C,!0);this.D=!1}x(Icf,Vbf);Icf.prototype.Ga=function(){Icf.Ia.Ga.call(this);Q(this.getElement(),"pub-dialog-published-content-container")};Icf.prototype.F=function(){return this.C.C};Icf.prototype.H=function(a){var b=this.C;b.C=a.clone();Gcf(b)};Icf.prototype.J=function(a){!a&&this.C.wk()&&(this.D=!0);this.C.Na(a);a&&this.D&&(this.Db()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function Jcf(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+V9e(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return V(b+a+"</div>")};function Kcf(a,b,c,d,e,f,h){var k=null!=h?qcf(h):null;h=new wcf(c,d,k,!0);k=new wcf(c,d,k,!1);M5.call(this,a,b,e,"spreadsheets",f,h,k,new Icf(c,d),"/publishingsettings",new Lcf);this.Re=c;this.tc=d}x(Kcf,M5);
Kcf.prototype.kEa=function(a){if(a.entireDocument)return new N5(!0,[],[]);var b=a.charts||"";a=Qc((a.sheets||"").split(","),function(c){return null!=tM(this.Re,c)},this);b=Qc(b.split(","),v(function(c){return!!this.tc.C(c)},this));b=Rc(b,function(c){var d=this.tc.C(c);return new vcf(c,d.xb())},this);return new N5(!1,a,b)};Kcf.prototype.ODa=function(){return new N5(!0,[],[])};
function dcf(a,b){if(b.F||null!=b.gi){var c="html"==b.D;a=hcf(a,c?"/pubhtml":"/pub");null!=b.gi&&(a=Qk(a,"gid",b.gi,"single","true"));c||(a=Qk(a,"output",b.D))}else a=Qk(hcf(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function ecf(a,b){var c=dcf(a,b);if(b.F||null!=b.gi)c=Qk(c,"widget","true","headers","false");a=b.C?(a=a.tc.C(b.C.id))?a.Xc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Ye(c)+'"></iframe>'}function Lcf(){}x(Lcf,P);Lcf.prototype.Aa=function(){this.sb(R(Jcf,{locale:"en-GB"}))};function Mcf(a,b,c,d){RR.call(this,134,a,b);this.F=c;this.C=d}u(Mcf,RR);Mcf.prototype.Kd=function(){var a=this.Pa().qc(),b=km(this.getRect(),a);a=new sH;I(a,1,b);b=ka(this.F);for(var c=b.next();!c.done;c=b.next())Vf(a,2,c.value);I(a,3,this.C);return a};Mcf.prototype.sM=function(){return tEb.xa()};function Ncf(a,b,c){b=c||b;c=a.OXb;var d=a.X9a;Ba(a.yQ);a=a.yQ;var e=$y("waffle-rd-title-data"),f=$y("waffle-rd-title-cta");c='<div class="'+W("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+W(e)+'"><div id="'+W(e)+'" class="'+W("waffle-rd-selection-description")+'" tabindex="0">'+U(c)+'</div><div class="'+W("waffle-rd-expand-to-range")+'"'+(d?"":' style="display: none;"')+' tabindex="0" role="button">'+U(d)+'</div><div class="'+W("waffle-rd-ignore-headers")+'"><span class="'+
W("waffle-rd-checkbox")+'"></span><div class="'+W("waffle-rd-checkbox-label")+'">'+U("Data has header row")+'</div></div></div><div class="'+W("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+W(f)+'"><div id="'+W(f)+'" class="'+W("waffle-rd-section-title")+'">';c=c+"Columns to analyse"+("</div>"+Ocf({yQ:a},b)+"</div>");return V(c)}
function Ocf(a){Ba(a.yQ);a=a.yQ;for(var b='<div class="'+W("waffle-rd-columns-container")+'">',c=a.length,d=0;d<c;d++){var e=a[d];b+='<div class="'+W("waffle-rd-columns-checkbox")+'"><span class="'+W("waffle-rd-checkbox")+'"></span><div class="'+W("waffle-rd-checkbox-label")+'">'+U(e.label)+"</div></div>"}return V(b+"</div>")};function Pcf(a,b,c,d,e){cB.call(this,void 0,!1);this.C=a;this.Sa=b;this.Ha=c;this.ea=d;this.R=e;this.O=Ox(new Nx,1).build();this.V=this.va=null;this.F={};this.L=null;this.J=new lT(!1,mT.getInstance(),this.oa())}u(Pcf,cB);r=Pcf.prototype;r.Ja=function(){cB.prototype.Ja.call(this);F(this.va);F(this.V);F(this.F);F(this.L)};
r.Aa=function(){cB.prototype.Aa.call(this);this.setTitle("Remove duplicates");Q(Qz(this),"waffle-rd-dialog-gm");if(!Qcf){var a=new Tz;a.set("cancel","Cancel",!1,!0);a.set("save","Remove duplicates");Qcf=a}Wz(this,Qcf);dA(this,"save");var b=this.C.Lc();a=b.height+(" rows and "+(b.width+" columns selected"));var c=jQd(this);c&&hx(c,"Remove duplicates "+a);c=null;Rcf(this)&&(c="Expand to "+VN(this.ea));b=Scf(this,b);b=Rc(b,function(d){return Tcf(d)});a=R(Ncf,{OXb:a,X9a:c,yQ:b});c=this.Fb();this.oa().appendChild(c,
a)};r.Ga=function(){cB.prototype.Ga.call(this);this.V=Qu("waffle-rd-expand-to-range",void 0);this.va=Qu("waffle-rd-selection-description",void 0);this.L=Qu("waffle-rd-columns-container",void 0);this.getHandler().listen(this,"dialogselect",this.vLb).listen(this,"change",this.Uhb).listen(this.J,"change",this.Dob).Cg(this.V,Zm,this.hHa);var a=this.C.Lc(),b=Qu("waffle-rd-ignore-headers",void 0);b=ev(b);var c=fv(b),d=this.J;d.Va(b);kT(d,c);d.Na(1<a.height);Ucf(this,a)};
r.vLb=function(a){var b=this;if("save"==a.key){a=Vcf(this);var c=Wcf(this,a),d=!!this.J.xm();a=new Mcf(this.C,a,c,d);WK(a,function(e,f){e?(f&&(e=H(f,1),e=(new IA("{ROWS,plural, =0{No duplicate rows were found.}=1{1 duplicate row found and removed.}other{{ROWS} duplicate rows found and removed.}}")).format({ROWS:e}),f=H(f,2),f=(new IA("{ROWS,plural, =1{1 unique row remains.}other{{ROWS} unique rows remain.}}")).format({ROWS:f}),f=Ge(e+"\n\n"+f),SK(f,"Remove duplicates")),b.R.C(35997,b.O)):b.R.C(35996,
b.O)});this.Ha.C(a);this.R.C(this.J.xm()?35993:35994,this.O)}else"cancel"==a.key&&this.R.C(35995,this.O)};r.hHa=function(){if(Rcf(this)){var a=this.ea,b=this.Sa;kK(this.C,a);rO(b.L);HR(b,!0);b=a.height+(" rows and "+(a.width+" columns selected"));this.va&&jv(this.va,b);var c=jQd(this);c&&hx(c,"Remove duplicates "+b);Xcf(this);this.L&&(b=Scf(this,a),b=Rc(b,function(d){return Tcf(d)}),b=R(Ocf,{yQ:b}),$u(this.L),Zu(this.L,b.childNodes),Ucf(this,a));this.J.Na(1<a.height);this.R.C(35998,this.O);this.focus()}};
r.Uhb=function(a){var b=Hd(this.F,function(e,f){return-1!=f});b=Ld(b);var c=this.F[-1];if(a.target==c){var d=c.xm();Nc(b,function(e){e.gc(d)})}a=Sc(b,function(e,f){return e+(f.xm()?1:0)},0);c.gc(a==b.length);Zz(this.D,"save",0<a)};r.Dob=function(){var a=this,b=this.C.Lc();b=Scf(this,b);Nc(b,function(c){var d=c.getColumn();d=a.F[d].getElement();d=fv(d);c=c.getLabel();jv(d,c)})};function Vcf(a){var b=a.C.Lc(),c=cm(b,"r");a.J.xm()&&1<c&&(b=Cua(b,-1));return b}function Xcf(a){(a=a.V)&&N(a,!1)}
r.B0a=function(){iK(this.C)&&this.hHa()};function Rcf(a){var b=a.C.Lc();return!!a.ea&&a.ea.Jh()>b.Jh()}r.UYb=function(){return iK(this.C)&&!Rcf(this)};function Ucf(a,b){var c=a.Li("waffle-rd-columns-checkbox");b=Scf(a,b);for(var d=0;d<c.length;d++){var e=b[d],f=ev(c[d]),h=fv(f),k=a.F[e.getColumn()],l=a,m=new lT(!1,mT.getInstance(),l.oa());m.Rd(l);var p=e.getColumn();l=l.F[p]=m;l.Va(f);kT(l,h);e=k?k.xm():e.xm();l.gc(e)}}
function Scf(a,b){var c=[];c.push(new Ycf(-1,"Select all"));var d=b.xc(),e=b.cd(),f=a.J.xm();for(b=b.Ac();d<e;d++){var h=QN(d),k=$e(xJ(a.C.wh(b,d)),25);c.push(new Ycf(d,zd(k)||!f?"Column "+h:"Column "+(h+(" - "+k))))}return c}function Wcf(a,b){var c=b.xc();b=b.cd();for(var d=[],e=null,f=c;f<b;f++)a.F[f].xm()?e?(e=Yf(e,1),e=Hua(e,f+1-c)):e=Hua(f-c,f+1-c):e&&(d.push(e),e=null);e&&d.push(e);return d}var Qcf=null;function Ycf(a,b){this.C=a;this.D=b}Ycf.prototype.getColumn=g("C");
Ycf.prototype.getLabel=g("D");Ycf.prototype.xm=n(!0);function Tcf(a){return{column:a.C,label:a.D,checked:!0}};function Zcf(a){a=""+$cf({id:"waffle-resize-selection-custom",xt:a.mia,pk:az("<br/>"+U(x$e({id:"waffle-resize-input",yd:"waffle-resize-inset-input"})))});a+=$cf({id:"waffle-resize-selection-auto",xt:$y("Fit to data"),pk:az("")});return V(a)}function $cf(a){var b=a.id,c=a.xt;a=a.pk;return V('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+W(b)+'"><label for="'+W(b)+'" class="waffle-resize-label">'+U(c)+"</label>"+U(a)+"</div>")}
function adf(a){a=a.mia;a='<div id="waffle-resize-input-error-butter-container" class="waffle-input-error-butter-container"><div id="waffle-resize-butter-bar-wrap" class="waffle-input-error-butter-wrap"></div></div>'+$cf({id:"waffle-resize-selection-custom",xt:$y("Specify row height"),pk:az('<div class="waffle-resize-row-input-container">'+U(x$e({id:"waffle-resize-input",yd:"waffle-resize-row-input"}))+'<label for="waffle-resize-input" class="waffle-resize-row-input-label">'+U(a)+"</label></div>")});
a+=$cf({id:"waffle-resize-selection-auto",xt:$y("Fit to data"),pk:az("")});return V(a)};function bdf(a,b,c,d,e){cB.call(this);this.J=a;this.V=b;var f=$l(this.J.Lc());this.O=f;this.C=Qc(cK(this.J),function(h){return $l(h)==f});this.R=new JA;this.L=new j1d;this.Sa=c;this.Ta=d;this.va=e;this.ea=this.D;this.F=null;this.Ha=this.J instanceof xmc}x(bdf,cB);r=bdf.prototype;r.Aa=function(){bdf.Ia.Aa.call(this);this.setTitle(cdf(this));"r"==this.O?this.Fb().appendChild(R(adf,{mia:ddf(this)})):this.Fb().appendChild(R(Zcf,{mia:ddf(this)}));dA(this,"ok")};
r.Ga=function(){bdf.Ia.Ga.call(this);var a=this.oa(),b="r"==this.O;this.R.Va(a.getElement("waffle-resize-input"));var c=this.J.Lc(),d=$l(c);c=tFb(BQb(this.J,d,Yl(c,d)));this.R.setValue(String(c));k1d(this.L,"waffle-resize-selection");if(b){a:{b=null;for(c=0;c<this.C.length;c++){d=this.C[c];for(var e=d.top,f=0;f<d.height;f++){var h=ritz_api.RitzModelApi.isDimensionForcedSize(this.J.Ta,!0,e+f);if(null==b)b=h;else if(b!=h){b=null;break a}}}b=b?"waffle-resize-selection-custom":"waffle-resize-selection-auto"}null!=
b?l1d(this.L,b):Zz(this.ea,"ok",!1);this.F=new iA(a.getElement("waffle-resize-input-error-butter-container"));this.F.setType("warning");this.F.setContent("");this.F.render(a.getElement("waffle-resize-butter-bar-wrap"));X4a(this.F,!0);this.F.setVisible(!1)}else l1d(this.L,"waffle-resize-selection-custom");this.Ha&&this.L.Na("waffle-resize-selection-auto",!1);this.getHandler().listen(this,"dialogselect",this.xLb).listen(this.R.getElement(),"focus",this.pBb).listen(this.R.getElement(),"change",this.wLb).listen(this.L,
"change",this.ywb)};r.pBb=function(){l1d(this.L,"waffle-resize-selection-custom");Zz(this.ea,"ok",!0)};r.ywb=function(){"r"==this.O&&(Zz(this.ea,"ok",!0),this.F.setVisible(!1))};r.wLb=function(){"r"==this.O&&this.F.setVisible(!1)};r.focus=function(){this.Db()&&"waffle-resize-selection-custom"==m1d(this.L)&&MA(this.R)};
function cdf(a){var b=a.C[0];if("r"==a.O){var c=b.Ac();b=b.Zc()-1;var d=String(ON(c+1)),e=String(ON(b+1));return 1<a.C.length?"Resize selected rows":c==b?"Resize row "+d:"Resize rows "+(d+(" - "+e))}c=b.xc();b=b.cd()-1;d=QN(c);return 1<a.C.length?"Resize selected columns":c==b?"Resize column "+d:"Resize columns "+(d+(" - "+QN(b)))}function ddf(a){return"c"==a.O?"Enter new column width in pixels. (Default: "+(uFb+")"):"pixels (Default: "+(MJ+")")}
r.xLb=function(a){if("ok"==a.key){var b="r"==this.O;if("waffle-resize-selection-custom"==m1d(this.L)){var c=jf(this.R.getValue()),d=isNaN(c)?"Entered value is not a number.":2>c||2E3<c?"Size must be between 2 and 2000 pixels.":null;null!=d?("r"==this.O?(this.F.setContent(d),this.F.setVisible(!0)):SK(d),a.preventDefault()):(this.va.C(b?35979:35308),a=this.Ha?new Mbd(this.J,c,this.C):new Kbd(this.J,this.C[0],c,this.C.slice(1)),b&&(a.L=!0),this.V.C(a))}else"waffle-resize-selection-auto"==m1d(this.L)&&
(b?(this.va.C(35980),this.V.C(new Kbd(this.J,this.C[0],null,this.C.slice(1)))):(cL(this.Sa),this.va.C(35307),Obd(this.C,this.Ta,this.V)))}};function edf(a){wi(this,a,0,-1,null,null)}x(edf,vi);r=edf.prototype;r.tH=function(){return K(this,2)};r.bda=function(a){L(this,2,a)};r.getType=function(){return K(this,3)};r.setType=function(a){L(this,3,a)};r.clearType=function(){L(this,3,void 0)};r.hasType=function(){return null!=K(this,3)};function fdf(a){a=a.bEb;return V('<div><div class="'+W("waffle-notification-helplink-container")+'" align="right"></div><div class="'+W("waffle-notification-rulearea-container")+" "+W("waffle-dialog-notifications-bounds")+'"><div class="'+W("waffle-notification-editrule-container")+'"></div><div class="'+W("waffle-notification-listrule-container")+'"></div></div>'+(a?"":'<div class="'+W("waffle-notification-addbutton-container")+'"></div>')+"</div>")}
function gdf(a){var b=a.w9a;a='<div class="'+W("waffle-dialog-notifications")+'"><div class="'+W("waffle-notification-rule-area")+'"><div class="'+W("waffle-dialog-notifications-toplabel")+'">';b="Notify me at "+(U(b)+" when...");a=a+b+('</div><div class="'+W("waffle-notification-top-group")+'" role="radiogroup"><div class="'+W("waffle-notification-any-change-container")+" "+W("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+W("waffle-notification-form-submit-container")+
" "+W("waffle-dialog-notifications-input")+'" role="presentation"></div></div><div class="'+W("waffle-notification-rule-area-separator")+'"></div><div class="'+W("waffle-dialog-notifications-label")+'">');a=a+"Notify me with..."+('</div><div class="'+W("waffle-notification-bottom-group")+'" role="radiogroup"><div class="'+W("waffle-notification-daily-digest-container")+" "+W("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+W("waffle-notification-right-away-container")+
" "+W("waffle-dialog-notifications-input")+'" role="presentation"></div></div></div><div class="'+W("waffle-notification-buttons-container")+'"></div></div>');return V(a)}
function hdf(a){a=a.lXb;return V('<div class="'+W("waffle-notification-rule-row")+'"><div class="'+W("waffle-notification-rule-description")+'"><span class="'+W("waffle-notification-rule-text")+'">'+U(a)+'</span></div><div class="'+W("waffle-notification-rulerow-buttons-container")+'"><div class="'+W("waffle-notification-rulerow-edit-container")+'"></div><div class="'+W("waffle-notification-rulerow-delete-container")+'" width="50px"></div></div><div class="'+W("waffle-notification-rule-separator")+
'"></div></div>')};function idf(a){P.call(this,a);a=SB.getInstance();this.ea=B(A(),"docs-egmd");this.R=this.O=this.H=this.L=this.J=this.F=null;this.V=a.C.email;this.C=this.D=null}u(idf,P);r=idf.prototype;
r.Aa=function(){P.prototype.Aa.call(this);var a=this.oa(),b=R(gdf,{w9a:this.V});this.sb(b);this.C=new jZ;this.qa(this.C);this.F=new iZ;this.F.wE(a.Aa("LABEL",null,"Any changes are made"));this.F.render(this.Ea("waffle-notification-any-change-container"));this.C.zI(this.F);this.J=new iZ;this.J.wE(a.Aa("LABEL",null,"A user submits a form"));this.J.render(this.Ea("waffle-notification-form-submit-container"));this.C.zI(this.J);this.D=new jZ;this.qa(this.D);this.H=new iZ;this.H.wE(a.Aa("LABEL",null,"Email - daily digest"));
this.H.render(this.Ea("waffle-notification-daily-digest-container"));this.D.zI(this.H);this.L=new iZ;this.L.wE(a.Aa("LABEL",null,"Email - straight away"));this.L.render(this.Ea("waffle-notification-right-away-container"));this.D.zI(this.L);b=this.Ea("waffle-notification-buttons-container");this.R=new Az("Cancel",a);this.Fa(this.R,!1);this.R.render(b);this.O=Bz("Save",a);this.Fa(this.O,!1);this.O.render(b);this.ea&&Q(this.O.getElement(),"waffle-notification-end-button")};
r.Ga=function(){P.prototype.Ga.call(this);this.getHandler().listen(this.O,"action",this.sXb,!0).listen(this.R,"action",v(this.dispatchEvent,this,new Rm("cancelRuleEdit"))).listen(this.C,"change",this.Vpa).listen(this.D,"change",this.Vpa)};r.Pb=function(a){P.prototype.Pb.call(this,a);a?1==a.getType()?kZ(this.C,this.F):2==a.getType()&&kZ(this.C,this.J):kZ(this.C,null);a?2==a.tH()?kZ(this.D,this.H):1==a.tH()&&kZ(this.D,this.L):kZ(this.D,null);this.Vpa()};
r.focus=function(){var a=lZ(this.C),b=mZ(this.C,0);(a||b).getElement().focus()};r.setVisible=function(a){this.getElement()&&N(this.getElement(),a)};r.sXb=function(){this.dispatchEvent(new Rm("saveRule",jdf(this)))};function jdf(a){var b=new edf,c=a.Pa();c&&(c=K(c,1),L(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?b.bda(1):a.H.isChecked()&&b.bda(2);return b}
r.Vpa=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Na(a)};function kdf(a){var b=a.aua;return V("<div><div>"+U(a.C2a)+"</div>"+U(dZc({id:"waffle-confirm-suppress-checkbox",yd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+U(b)+"</span></div>")};function ldf(a,b,c,d,e,f,h){var k=B(A(),"docs-egmd");if(Ga(c)){var l=new Tz;k&&l.set("cancel",c.cancel,!1,!0);l.set("ok",c.ok,!0);k||l.set("cancel",c.cancel,!1,!0)}else l=k?W8a():o4a();return mdf(d||"Heads up!",a,b,l,e,f,h)}
function mdf(a,b,c,d,e,f,h){b=Ge(b);if(f){b=My(kdf({C2a:b,aua:f}));var k=new nT;var l=c;c=function(){l(k.isChecked())}}a=D4a(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Fa(k),k.Va(pv(a.oa(),"waffle-confirm-suppress-checkbox")),c=pv(a.oa(),"waffle-confirm-suppress-label"),kT(k,c),k.gc(!1));return a};function ndf(a,b){P.call(this,b);this.Pb(a)}u(ndf,P);
ndf.prototype.Aa=function(){P.prototype.Aa.call(this);var a=this.Pa(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==a.tH()?c+="send digest email":1==a.tH()&&(c+="send email");a=R(hdf,{lXb:"If "+(b+(" then "+c))});this.sb(a);a=Ax(Sx,"waffle-notifications-add");this.D=new Ux("Edit",a,this.oa());this.D.$c("goog-link-button");this.D.$c("menuMainLink");this.Fa(this.D,!1);this.D.render(this.Ea("waffle-notification-rulerow-edit-container"));this.C=new Ux("Delete",
a,this.oa());this.C.$c("goog-link-button");this.C.$c("menuMainLink");this.Fa(this.C,!1);this.C.render(this.Ea("waffle-notification-rulerow-delete-container"))};ndf.prototype.Ga=function(){P.prototype.Ga.call(this);this.getHandler().listen(this.D,"action",this.H);this.getHandler().listen(this.C,"action",this.F)};ndf.prototype.H=function(){this.dispatchEvent(new Rm("edit",this.Pa()))};
ndf.prototype.F=function(){var a=v(function(){this.dispatchEvent(new Rm("del",this.Pa()))},this),b=v(function(){this.C.getElement().focus()},this);ldf("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function odf(a){P.call(this,a)}u(odf,P);odf.prototype.Aa=function(){var a=this.oa().Aa("DIV",{className:"waffle-dialog-notifications-list",width:"100%"});this.sb(a)};odf.prototype.setVisible=function(a){this.getElement()&&N(this.getElement(),a)};function pdf(a,b,c){cB.call(this,void 0,!1,c);this.V=b;this.L=a;this.setTitle("Set notification rules");Sz(this,!1);a=new Tz;a.set("cancel","Done",!1,!0);Wz(this,a);this.C=new idf(c);this.Fa(this.C,!1);this.J=new odf;this.Fa(this.J,!1);this.F=new Ux("Add another notification rule",wO.getInstance(),this.oa());this.Fa(this.F,!1);this.O=new Ux("Help",wO.getInstance(),this.oa());this.Fa(this.F,!1);this.R=B(A(),"docs-egmd")}u(pdf,cB);r=pdf.prototype;
r.Aa=function(){cB.prototype.Aa.call(this);var a=this.oa();Q(Qz(this),"waffle-notifications-dialog");a.appendChild(this.Fb(),R(fdf,{bEb:this.R}));if(this.R){var b=a.Aa("DIV","waffle-notification-helpbutton-container");this.O.render(b);a.appendChild(Nz(this),b);b=a.Aa("DIV","waffle-notification-addbutton-container");this.F.render(b);a.Eu(Pz(this),b,0)}else b=a.Aa("A",{target:"_blank"},"Help"),Pe(b,"https://support.google.com/docs/answer/91588"),a.appendChild(this.Ea("waffle-notification-helplink-container"),
b),this.F.render(this.Ea("waffle-notification-addbutton-container"));this.J.render(this.Ea("waffle-notification-listrule-container"));this.C.render(this.Ea("waffle-notification-editrule-container"));dA(this,"")};r.Ga=function(){cB.prototype.Ga.call(this);this.getHandler().listen(this,"edit",this.ALb).listen(this,"del",this.zLb).listen(this.F,"action",this.yLb).listen(this,"saveRule",this.rXb).listen(this,"cancelRuleEdit",this.G1a).listen(this.O,"action",function(){return Ww("https://support.google.com/docs/answer/91588")})};
r.R0=function(a){this.isDisposed()||(this.C.setVisible(!1),qdf(this,!1),jk(this.L,"/notifications/list",v(this.E0b,this,a)).$e())};
r.E0b=function(a,b,c){if(!this.isDisposed()){b=c.We();c=[];for(var d=0;d<b.length;d++)c[d]=new edf(b[d]);this.Pb(c);if(a&&0==c.length)rdf(this,null,!1);else{if(a=this.Pa())if(b=this.J,b.ld(!0),b.oa().ld(b.Fb()),b.Pb(a),c=b.oa(),0==a.length)c.appendChild(b.Fb(),c.Aa("DIV",null,c.Aa("DIV",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Fa(new ndf(a[d],c),!0);qdf(this,!0);this.focus()}}};
r.rXb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();K(a,1)?Fo(jk(this.L,"/notifications/set",v(this.R0,this,!1)),{rule:b}).$e():Fo(jk(this.L,"/notifications/create",v(this.R0,this,!1)),{rule:b}).$e();if(1==a.getType())a=1==a.tH()?36011:36010;else if(2==a.getType())a=1==a.tH()?36013:36012;else throw Error("Unexpected rule type: "+a.getType());b=Ox(new Nx,1).build();this.V.C(a,b)};r.G1a=function(){this.C.setVisible(!1);this.R0(!1)};r.ALb=function(a){rdf(this,a?a.target:null,!0)};
r.yLb=function(){rdf(this,null,!0)};function rdf(a,b,c){qdf(a,!1);var d=a.C;d.Pb(b);d.setVisible(!0);c&&a.C.focus()}r.zLb=function(a){this.J.setVisible(!1);a=a.target;Fo(jk(this.L,"/notifications/delete",v(this.R0,this,!1)),{rule_id:K(a,1)}).$e()};function qdf(a,b){a.J.setVisible(b);var c=Pz(a);N(c,b);a.F.setVisible(b)}r.show=function(){this.setVisible(!0);this.R0(!0)};function sdf(a,b,c,d,e){VK.call(this,68);this.O=a;this.L=b;this.F=c;this.J=d;this.C=e}u(sdf,VK);sdf.prototype.Kd=function(){var a=new jH;this.O&&I(a,1,this.O);ra(this.L)&&I(a,2,this.L);ra(this.F)&&I(a,3,this.F);this.J&&I(a,4,this.J);ra(this.C)&&I(a,5,this.C);return a};sdf.prototype.j0=function(a,b){(ra(this.F)||ra(this.J)||ra(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);VK.prototype.j0.call(this,a,b)};function tdf(a,b,c){b=c||b;c=a.oZb;var d='<tr class="dialog-settings-general-settings-div"><div class="dialog-settings-display-language">';a='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(U(a.T3a)+"</a>");d=d+a+"</div>";c&&(d+='<div class="dialog-settings-english-name-div">'+U(dZc({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
d+="Always use English function names</label></div>");return V(d+"</tr>")}function udf(){return V('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function vdf(a,b,c,d){cB.call(this);this.Jb=a;this.Ec=b;this.L=c;this.kc=d;this.C={};this.yb=this.Ya=!1;this.Ub=this.Cb=this.cb="";this.tc=new Xj;this.J=[];this.F=this.tc.Tc(Br.xa(),ritz_api.RitzModelApi.getWorkbookProperties());this.setTitle("Settings for this spreadsheet");this.Xa=!1;this.V=null;this.Sa=new nT;this.Fa(this.Sa);this.R=new cW;this.Fa(this.R);this.O=new cW;this.Fa(this.O);this.bb=new vU;this.Fa(this.bb);this.Ha=this.Ta=null;this.Vb=new FA(1);this.ea=this.va="";wdf(this,0);wdf(this,
1);wdf(this,2);wdf(this,3);this.C[4]=new JA;this.C[5]=new JA}x(vdf,cB);var xdf=null,ydf=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],zdf=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];function wdf(a,b){a.C[b]=P$e();a.C[b].hV=!0}r=vdf.prototype;
r.Aa=function(){vdf.Ia.Aa.call(this);var a=this.Fb();Q(this.getElement(),"dialog-settings");var b=this.oa(),c=[Adf(b,"Locale","waffle-settings-label-locale"),Bdf(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),Cdf(this),Adf(b,"Time zone","waffle-settings-label-timezone"),Bdf(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1,"waffle-settings-label-timezone",
"waffle-settings-description-timezone"),Cdf(this)],d=[];d.push(Adf(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(Bdf(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(Cdf(this));d.push(Adf(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=b.Aa("A",{target:"_blank",href:"https://support.google.com/docs/answer/58515"}," Learn more about iterative calculation.");
d.push(Bdf(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=Adf(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=Bdf(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");Ddf(e);d.push(e);this.J.push(e);
e=Adf(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=Bdf(this,b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");Ddf(e);d.push(e);this.J.push(e);"OFF"==this.C[3].zf().getValue()&&Edf(this);d.push(Cdf(this));c=gd(c,d);c.push(R(tdf,{T3a:this.Cb,oZb:this.Xa}));this.Ta=b.Aa("TABLE","dialog-settings",b.Aa("TBODY",null,
c));this.Ha=b.Aa("table","dialog-settings",b.Aa("tbody",null,d));c=R(udf);b.appendChild(a,c);this.bb.Va(c);b.appendChild(a,this.Ta);b.appendChild(a,this.Ha);N(this.Ha,!1);xdf||(a=new Tz(b),B(A(),"docs-egmd")?(a.set("cancel","Cancel",!1,!0),a.set("save","Save settings",!0)):(a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0)),xdf=a);Wz(this,xdf);Fdf(this,4,Tf(this.F,3)&&H(this.F,3).X9()?H(this.F,3).L7().toString():"50");Fdf(this,5,Tf(this.F,3)&&H(this.F,3).T9()?H(this.F,3).u7().toString():
"0.05");dA(this,"save")};function Ddf(a){a=a.firstChild.firstChild;Q(a,"jfk-textinput");rw(a,"width","7em")}function Edf(a){for(var b=0;b<a.J.length;b++)N(a.J[b],!1)}function Adf(a,b,c){return a.Aa("TR",null,a.Aa("TD",{id:c,"class":"dialog-settings-label"},b))}function Bdf(a,b,c,d,e,f,h){b=b.Aa("TR",null,b.Aa("TD","dialog-settings-input"),b.Aa("TD",{id:f,"class":"dialog-settings-text"},c,h||null));a=a.C[d];a.render(b.firstChild);a=a.Ma();ex(a,"labelledby",e);ex(a,"describedby",f);return b}
function Cdf(a){a=a.oa();return a.Aa("TR",null,a.Aa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Aa("HR",{"class":"dialog-settings-sep"})))}
r.Ga=function(){vdf.Ia.Ga.call(this);Wm(this,"dialogselect",v(this.BLb,this));this.getHandler().listen(this.C[3],"action",this.DZb);this.getHandler().listen(this.bb,"select",this.Wzb);var a=this.C[4].getElement();this.R.Fj(a);fW(this.R,a,a);this.R.render();eW(this.R);this.getHandler().listen(a,"change",v(this.d1b,this));a=this.C[5].getElement();this.O.Fj(a);fW(this.O,a);this.O.render();eW(this.O);this.getHandler().listen(a,"change",v(this.c1b,this));if(this.Xa){a=this.oa().getElement("waffle-settings-dialog-english-name-checkbox");
var b=this.oa().getElement("waffle-settings-dialog-english-name-checkbox-label");this.Sa.Va(a);kT(this.Sa,b);this.Sa.gc(f$b(this.L.H))}};
r.setVisible=function(a){if(a){if(!this.Ya){Gdf(this);return}var b=this.L.L;Fdf(this,0,b.C);b=b.H||FFc().name();this.V&&this.V[b]&&(b=this.V[b]);Fdf(this,1,b);Fdf(this,2,Tf(this.F,3)&&H(this.F,3).ena()?H(this.F,3).Hja().toString():"");Fdf(this,3,Tf(this.F,3)&&Tf(H(this.F,3),1)?H(H(this.F,3),1)?"ON":"OFF":"OFF")}vdf.Ia.setVisible.call(this,a);this.Ya&&!this.yb&&((a=Mu("ds-settings-link"))&&Pe(a,this.cb),this.yb=!0)};
function Gdf(a){lk(Jo(a.Ec.mf("/info/settings"),Hdf(a)),v(function(b){b=b.We();(b={locale:b.l?Idf(b.l):null,DUa:b.tz?Idf(b.tz):null,T_b:b.tza,Z3a:b.dls,hFb:b.dln,a1b:b.hl},b.locale)&&b.DUa&&(Jdf(this,0,b.locale),Jdf(this,1,b.DUa),Jdf(this,2,ydf),Jdf(this,3,zdf),this.cb=b.Z3a,this.Cb=b.hFb,this.Ub=b.a1b,this.V=b.T_b,this.Xa=ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Ub),this.Ya=!0);this.setVisible(!0)},a)).$e()}
function Hdf(a){var b=nl(sv(a.oa()).location.href);a=ll(b,"hl");b=ll(b,"forcehl");return["hl",a,"forcehl",b]}function Jdf(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Yx(e.caption,e.value);a.Qc(e);dx(e.getElement(),"menuitem")}a.Tb().getElement().style.overflow="auto";a.Vj(!0)}function Idf(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b}function Fdf(a,b,c){(a=a.C[b])&&a.setValue(c)}
r.BLb=function(a){if("save"==a.key)if("ON"!=this.C[3].zf().getValue()||""==this.va&&""==this.ea){Kdf(this);a=this.L.L.C;var b=this.L.L.H;this.V&&b&&this.V[b]&&(b=this.V[b]);this.Jb.C(Ldf(this));Mdf(this,0,a)||Mdf(this,1,b)?(this.Jb.C(Ndf(this)),Odf(this)):(this.Xa?(b=f$b(this.L.H),a=this.Sa.isChecked(),b!=a?(H$b(this.L,a),b=Ox(new Nx,1).build(),this.kc.C(a?2433:2434,b),a=!0):a=!1):a=!1,a&&Odf(this))}else a.preventDefault(),Kdf(this),""!=this.va&&dW(this.R,this.va,!0),""!=this.ea&&dW(this.O,this.ea,
!0)};r.DZb=function(a){if("ON"==a.target.getValue())for(a=0;a<this.J.length;a++)N(this.J[a],!0);else Edf(this);Kdf(this)};function Kdf(a){eW(a.R);eW(a.O)}r.d1b=function(){this.va="";var a=this.C[4].getValue()||"";a=this.Vb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.va="Please enter an integer value.";else if(0>=a||1E4<a)this.va="Please enter a value between 1 and 10000."};
r.c1b=function(){this.ea="";var a=this.C[5].getValue()||"";a=this.Vb.parse(a);isNaN(a)?this.ea="Please enter a numeric value.":0>a&&(this.ea="Please enter a non-negative value.")};r.Wzb=function(a){switch(a.target.getId()){case "general-settings-tab":N(this.Ta,!0);N(this.Ha,!1);break;case "calculation-settings-tab":N(this.Ta,!1),N(this.Ha,!0)}};
function Ldf(a){var b=a.C,c=b[2].zf().getValue(),d=b[3].zf().getValue();a=b[4].getValue()||"";b=b[5].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new sdf(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}function Ndf(a){var b=a.C;a=a.L.L;var c=b[0].zf();c=null==c?a.C:c.getValue();b=b[1].zf();b=null==b?a.H||FFc().name():b.getValue();return new CFc(c,b)}function Mdf(a,b,c){a=a.C[b].zf();return null!=a&&a.getValue()!=c}
function Odf(a){Bm(a.L.D.C,function(){sv(a.oa()).location.reload()})}r.Ja=function(){Gd(this.C,F);delete this.C;vdf.Ia.Ja.call(this)};function Pdf(a,b,c,d,e,f,h,k){cB.call(this,void 0,!1,k);this.R=this.J=this.O=this.ea=this.V=null;this.Sa=a;this.C=b;this.va=h;this.F=[];this.Ha=new vxd(a,d,e,f);this.L=B(A(),"docs-egmd")}u(Pdf,cB);r=Pdf.prototype;
r.Aa=function(){cB.prototype.Aa.call(this);var a=this.oa();if(this.L){var b=Qz(this);Q(b,"waffle-sort-dialog-gm");Q(b,"docs-material")}var c=this.C.Lc();b=UN(dm(c));var d=UN(new ul(c.left+c.width-1,c.top+c.height-1));this.setTitle("Sort range from "+(b+(" to "+d)));Qdf||(b=new Tz,this.L?(b.set("cancel","Cancel",!1,!0),b.set("save","Sort")):(b.set("save","Sort"),b.set("cancel","Cancel",!1,!0)),Qdf=b);Wz(this,Qdf);dA(this,"save");var e;b=a.Aa("DIV","waffle-sort-dialog-data-header",d=a.Aa("SPAN",this.L?
void 0:"jfk-checkbox"),e=a.Aa("SPAN","waffle-sort-dialog-data-header-checkbox-label","Data has header row"));var f=this.R=this.L?new lT(!1,mT.getInstance(),a):new nT(void 0,a);f.Va(d);kT(f,e);1==c.height&&f.Na(!1);oO(this.Sa,this.C.qc(),c,!1)||(f.gc(!0),f.Na(!1));B(A(),"fetdrisd")&&ritz_api.TablesApi.getTables((new Xj).serialize(km(c,this.C.qc())),v(function(h){if(0<h.length){var k=h[0];h=mm(k.getDimensionTableAccessor().getHeaderRange());if(k=ritz_api.TablesApi.isRowBased(k)&&1==Mua(im(h)))k=km(c,
this.C.qc()),k=h.xb()==k.xb()&&Iua(im(h),im(k))&&Iua(jm(h),jm(k));k&&f.gc(!0)}},this));d=this.Fb();a.appendChild(d,b);this.V=a.Aa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Aa("TABLE",{cellSpacing:"0",width:"100%"},this.ea=a.Aa("TBODY")));a.appendChild(d,this.V);b=Rdf(this);this.F.push(b);this.L?(this.J=new Ux("Add another sort column",Tx.getInstance(),a),this.Fa(this.J,!0),kv(this.J.getElement(),!0)):(b=a.Aa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column"),
a.appendChild(d,b),kv(b,!0),dx(b,"button"),this.O=b)};r.Ga=function(){cB.prototype.Ga.call(this);var a=this.getHandler();a.listen(this,"dialogselect",this.HLb).listen(this.R,"change",this.dob);this.L?a.listen(this.J,"action",this.nGa):a.Cg(this.O,Zm,this.nGa)};
function Rdf(a){var b=a.oa(),c=0==a.F.length,d=new Sdf(a,c,a.C,a.F.length,b),e=b.Aa("TR",null,b.Aa("TD",{colspan:a.L?"5":"4"},b.Aa("DIV","waffle-sd-row-separator")));d.render(a.ea);b.appendChild(a.ea,e);c||(b=a.getHandler(),d.C&&b.Cg(d.C,Zm,v(a.r3a,a,d)));a=Tdf(a);Udf(d,a);return d}r.r3a=function(a){var b=this.F;if(1<b.length){var c=Mc(b,a);-1!=c&&(fd(b,c),b=a.getElement(),b=fv(b),a.dispose(),bv(b),this.O&&(N(this.O,!0),this.O.focus()),this.J&&this.J.setVisible(!0),TK("Sort criteria removed."))}};
function Tdf(a){var b=a.C.Lc(),c=b.xc();b=b.cd();var d=Rc(a.F,function(k){return Vdf(k)},a);if(d)for(var e=a.C.eM(d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.sD(f);if(!Xc(d,h))return h}return null}r.dob=function(){for(var a=this.F,b=0;b<a.length;b++)Udf(a[b])};
r.nGa=function(){var a=cm(this.C.Lc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(Rdf(this)),TK("Sort criteria added."));zw(Lc(this.F).getElement(),this.V,!0);this.V.scrollLeft=0;this.F.length>=a&&(this.L&&this.J?this.J.setVisible(!1):N(this.O,!1))};
r.HLb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(Vdf(e));e=e.F.isChecked();b.push(e?1:0)}c=this.C.Lc();d=cm(c,"r");this.R.isChecked()&&1<d&&(c=Cua(c,-1));d=Ox(new Nx,1).build();this.va.C(this.R.isChecked()?35697:35698,d);a=new sxd(a,b,this.C,c,this.R.isChecked());wxd(this.Ha,this.C,a)}};r.Ja=function(){cB.prototype.Ja.call(this);xf(this.F)};var Qdf=null;
function Sdf(a,b,c,d,e){P.call(this,e);this.L=this.O=this.F=this.D=this.C=null;this.R=-1;this.ea=a;this.H=b;this.J=c;this.V=B(A(),"docs-egmd")}u(Sdf,P);function Vdf(a){return(a=a.D.zf())?a.getValue():-1}
Sdf.prototype.Aa=function(){var a=this.oa(),b=this.H?"Sort by":"then by",c,d;var e=Ev("delete-grey600-24");this.H||(this.C=this.V?R(kB,{icon:e}):a.Aa("SPAN",{title:"Remove sort criteria."},"x"));var f=a.Aa("TD","waffle-sd-delete",this.H?"":this.C),h=a.Aa("TD","waffle-sd-td-rules",a.Aa("LABEL",{id:Sw(this,"csl")},b)),k=b=a.Aa("TD","waffle-sd-column-selector"),l=a.Aa("TD","waffle-sd-td-ascending",d=a.Aa("DIV",null,c=a.Aa("DIV",{"class":"waffle-sort-dialog-radio-option",title:"Ascending"}),e=a.Aa("DIV",
{"class":"waffle-sort-dialog-radio-option",title:"Descending"})));f=this.V?a.Aa("TR","waffle-sd-tr-rules",h,k,l,f):a.Aa("TR","waffle-sd-tr-rules",f,h,k,l);dx(d,"radiogroup");d=this.F=new iZ(a,uv(a,sB(gF(!0,this.Ee()))),"ascending");d.render(c);a=this.O=new iZ(a,uv(a,sB(gF(!1,this.Ee()))),"descending");a.render(e);this.L=new jZ([d,a]);kZ(this.L,d);a=this.D=P$e();a.render(b);ex(a.getElement(),"label",this.H?"Select first column to sort by:":"Select next column to sort by:");this.C&&(kv(this.C,!0),dx(this.C,
"button"),hx(this.C,"Remove sort criteria."));this.sb(f)};function Udf(a,b){var c=a.oa(),d=a.ea.R.isChecked(),e=a.J.Lc(),f=e.Ac(),h=e.xc();e=e.cd();a.R=b||Vdf(a);for(b=a.D.oi();0<b;b--)a.D.Yl(0);for(;h<e;h++)b=$e(xJ(a.J.wh(f,h)),25),b=new Yx(zd(b)||!d?"Column "+QN(h):b,a.J.sD(h),c),b.$c("waffle-sd-menu-item"),a.D.Qc(b);a.D.ef(0);0<=a.R&&a.D.setValue(a.R)}Sdf.prototype.Ja=function(){P.prototype.Ja.call(this);this.D=this.C=this.J=this.ea=null;F(this.F);F(this.O);F(this.L);this.L=this.O=this.F=null};function Wdf(a,b,c,d){C5.call(this,a,b,c,d,!1)}u(Wdf,C5);Wdf.prototype.O=n("If you continue to edit, the following features will be removed or replaced in the file. The original file with full Office features is always available from File > Version history");function Xdf(a,b,c){return C4a(a||"There was a problem",Ge(b),void 0,void 0,void 0,void 0,c)};function Ydf(){JK.apply(this,arguments)}u(Ydf,JK);r=Ydf.prototype;r.V$a=function(){return Xdf};r.vab=function(){return ldf};r.oQb=function(a,b,c,d){var e=new jB;a=new cA(a,b,c,d,void 0,!0,void 0);dA(a,"ok");b=v(e.Va,e);a.Lna=b;a.qa(e);a.Ri=!0;a.L8=Cea(zd);return a};r.kcb=function(){return bdf};r.$2a=function(a,b,c,d,e,f,h){return new Pdf(a,b,c,d,e,f,h,void 0)};r.Y2a=function(a,b,c,d,e){return new Pcf(a,b,c,d,e)};r.Fab=function(){return uaf};r.vEa=function(){return lbf};r.Ika=function(){return sbf};
r.uEa=function(){return tbf};r.EDa=function(){return Z9e};r.Xab=function(){return ubf};r.pcb=function(){return vdf};r.ocb=function(){return Kcf};r.Wbb=function(){return Cbf};r.ncb=function(){return pdf};r.zab=function(){return M$e};r.lcb=function(){return I$e};r.mcb=function(){return gbf};r.yab=function(){return r$e};r.Pab=function(){return l$e};r.Qcb=function(){return Wdf};r.fab=function(){return p$e};r.X$a=function(){return m$e};PK("dialogs",Ydf);
