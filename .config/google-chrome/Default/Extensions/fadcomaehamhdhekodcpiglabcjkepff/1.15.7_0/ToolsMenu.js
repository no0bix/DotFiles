!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=160)}({10:function(e,t,n){"use strict";t.__esModule=!0;var o=n(2),i=n(6),r=function(){function e(e,t,n){var i=this;this.success=!1,this.getRoot=function(){return i._root},this.getId=function(){return i._id},this.isSuccessful=function(){return i.success},this.setData=function(e){return i.returnData=e},window.r20esDialogId="r20esDialogId"in window?window.r20esDialogId:0,this.centerWorkaround=null!==n&&void 0!==n&&n,this._id="r20es-dialog-"+window.r20esDialogId++,this._root=o.DOM.createElement("dialog",{className:e,style:t,id:this.getId()}),document.body.insertBefore(this.getRoot(),document.body.firstElementChild),window.dialogPolyfill&&window.dialogPolyfill.registerDialog(this.getRoot()),this.close=this.close.bind(this),this.dispose=this.dispose.bind(this)}return e.prototype.internalRender=function(){var e=this;this.getRoot().appendChild(this.render()),window.dialogPolyfill&&window.dialogPolyfill.reposition(this.getRoot()),this.centerWorkaround&&setTimeout(function(){e.recenter()},100)},e.prototype.recenter=function(){var e=this.getRoot(),t=document.body.scrollTop||document.documentElement.scrollTop,n=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,n)+"px"},e.prototype.rerender=function(){i.removeAllChildren(this.getRoot()),this.internalRender()},e.prototype.internalShow=function(){i.removeAllChildren(this.getRoot()),this.success=!1,this.internalRender(),this.getRoot().showModal()},e.prototype.getData=function(){var e=this.returnData;return this.returnData=null,e},e.prototype.close=function(e){void 0===e&&(e=!1),this.success="boolean"==typeof e&&e,this.getRoot().open&&this.getRoot().close()},e.prototype.dispose=function(){this.close(),i.findByIdAndRemove(this.getId())},e}();t.DialogBase=r},11:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();t.__esModule=!0;var i=n(2),r=n(6),a=function(e){function t(t,n,o){var r=e.call(this,n,o)||this;return r.show=r.internalShow,r.render=function(){return i.DOM.createElement(s,null,i.DOM.createElement(l,null,i.DOM.createElement("h3",null,r.action,", please wait...")))},r.action=t,r}return o(t,e),t}(n(10).DialogBase);function l(e){return i.DOM.createElement("div",{className:"dialog-body"})}function s(e){return i.DOM.createElement("div",{className:"r20es-dialog"})}t.LoadingDialog=a,t.DialogHeader=function(e){return i.DOM.createElement("div",{className:"dialog-header"})},t.DialogBody=l,t.DialogFooter=function(e){return i.DOM.createElement("div",{className:"dialog-footer"},i.DOM.createElement("hr",null))},t.DialogFooterContent=function(e){return i.DOM.createElement("div",{className:"dialog-footer-content"})},t.Dialog=s,t.CheckboxWithText=function(e){var t=r.copy(e,{style:{verticalAlign:"middle",marginRight:"4px"},type:"checkbox"}),n=i.DOM.createElement("input",t),o=t&&t.component||"div";return i.DOM.createElement(o,null,n,i.DOM.createElement("span",{style:{verticalAlign:"middle"}},t.checkboxText))}},160:function(e,t,n){"use strict";(function(e){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();t.__esModule=!0;var i=n(4),r=n(2),a=n(6),l=n(85),s=n(86),u=n(161),c=function(t){function n(){var n=t.call(this,e)||this;return n.dialog=null,n.onButtonClick=function(e){e.stopPropagation(),n.dialog.show()},n}return o(n,t),n.prototype.setup=function(){this.dialog=new u.ToolsDialog;var e=r.DOM.createElement(l.SettingsSidebarButton,{id:n.TOOLS_ID,text:"R20ES Tools",onClick:this.onButtonClick});s.insertButtonIntoSettings(e)},n.prototype.dispose=function(){t.prototype.dispose.call(this),a.findByIdAndRemove(n.TOOLS_ID),this.dialog&&this.dialog.dispose()},n.TOOLS_ID="r20es-tools-button",n}(i.R20Module.OnAppLoadBase);i.R20Module.canInstall()&&(new c).install(),console.log("TOOLS")}).call(this,"src/modules/ToolsMenu")},161:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();t.__esModule=!0;var i=n(10),r=n(11),a=n(2),l=n(162),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickUse=function(e){e.stopPropagation();var n=e.target.getAttribute("data-id");if(n){var o=l.default[n];if(o){var i=o.factory();t.setTool(i,o)}else alert("Could not find tool.")}else alert("Could not find the tool id.")},t.onGoBack=function(e){e.stopPropagation(),t.setTool(null,null)},t}return o(t,e),t.prototype.show=function(){this._currentTool=null,this.internalShow()},t.prototype.setTool=function(e,t){this._currentTool=e,this._currentToolConfig=t,this.rerender()},t.prototype.render=function(){if(this._currentTool&&this._currentToolConfig){var e=this._currentTool.show();return a.DOM.createElement(r.Dialog,null,a.DOM.createElement(r.DialogHeader,null,a.DOM.createElement("h1",null,this._currentToolConfig.name)),a.DOM.createElement(r.DialogBody,null,e),a.DOM.createElement(r.DialogFooter,null,a.DOM.createElement(r.DialogFooterContent,null,a.DOM.createElement("button",{className:"btn",onClick:this.close},"Close"),a.DOM.createElement("button",{className:"btn",onclick:this.onGoBack},"Back"))))}this._currentTool=null,this._currentToolConfig=null;var t=[],n={marginTop:"auto",marginBottom:"auto",paddingLeft:"8px",paddingRight:"8px"};for(var o in l.default){var i=l.default[o];t.push(a.DOM.createElement("b",{style:n},i.name)),t.push(a.DOM.createElement("div",{style:n},i.description)),t.push(a.DOM.createElement("button",{onClick:this.onClickUse,"data-id":o,style:n,className:"btn btn-info"},"Use"))}return a.DOM.createElement(r.Dialog,null,a.DOM.createElement(r.DialogHeader,null,a.DOM.createElement("h1",null,"Tools")),a.DOM.createElement(r.DialogBody,null,a.DOM.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"}},t)),a.DOM.createElement(r.DialogFooter,null,a.DOM.createElement(r.DialogFooterContent,null,a.DOM.createElement("button",{className:"btn",onclick:this.close},"Close"))))},t}(i.DialogBase);t.ToolsDialog=s},162:function(e,t,n){"use strict";t.__esModule=!0;var o={};!function(e){o[e.id]=e}(n(163).default),t.default=o},163:function(e,t,n){"use strict";t.__esModule=!0;var o=n(164),i={id:"sheetRollTypeSetterTool",description:"Allows bulk changing 5e OGL sheet roll queries, whisper types and damage auto roll settings.",name:"Bulk 5e OGL Roll type setter",factory:function(){return new o.SheetRollTypeSetter}};t.default=i},164:function(e,t,n){"use strict";t.__esModule=!0;var o=n(2),i=n(5),r=[{label:"Advantage Roll Queries",attributeName:"rtype",valueDisplayMap:{"{{always=1}} {{r2=[[@{d20}":"Always Roll Advantage","@{advantagetoggle}":"Advantage Toggle","{{query=1}} ?{Advantage?|Normal Roll,&#123&#123normal=1&#125&#125 &#123&#123r2=[[0d20|Advantage,&#123&#123advantage=1&#125&#125 &#123&#123r2=[[@{d20}|Disadvantage,&#123&#123disadvantage=1&#125&#125 &#123&#123r2=[[@{d20}}":"Query Advantage","{{normal=1}} {{r2=[[0d20":"Never Roll Advantage"}},{label:"Whisper Rolls To GM",attributeName:"wtype",valueDisplayMap:{"":"Never Whisper Rolls","@{whispertoggle}":"Whisper Toggle","?{Whisper?|Public Roll,|Whisper Roll,/w gm }":"Query Whisper","/w gm ":"Always Whisper Rolls"}}],a=function(e){e.stopPropagation();var t=e.target;t.disabled=!0;try{var n=t.getAttribute("data-key");if(!n)return void alert("Could not find attribute name.");var o=r.find(function(e){return e.attributeName===n});if(!o)return void alert("Could not find attribute.");var a=$(t.parentNode).find("select")[0];if(!a)return void alert("Could not find select element.");for(var s=a.value,u=i.R20.getAllCharacters(),c={current:s},d=0,f=u;d<f.length;d++){for(var g=f[d],p=null,h=0,m=g.attribs.models;h<m.length;h++){var v=m[h];if(v.attributes.name===o.attributeName){p=v;break}}p||(p=g.attribs.create({name:o.attributeName})),p.save(c)}}catch(e){console.error(e),alert("Error: "+e)}finally{t.disabled=!1,t.innerText=l+" (done!)"}},l="Set for all",s=function(e){var t=[];for(var n in e.valueDisplayMap)t.push(o.DOM.createElement("option",{value:n},e.valueDisplayMap[n]));return o.DOM.createElement("div",{style:{display:"grid",gridTemplateColumns:"2fr 3fr 1fr"}},o.DOM.createElement("span",null,e.label),o.DOM.createElement("select",null,t),o.DOM.createElement("button",{"data-key":e.attributeName,onClick:a,className:"btn btn-primary"},l))},u=function(){function e(){}return e.prototype.show=function(){return o.DOM.createElement("div",null,r.map(s))},e}();t.SheetRollTypeSetter=u},2:function(e,t,n){"use strict";var o,i=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};t.__esModule=!0,function(e){e.rerender=function(e,t){var n=e.nextSibling,o=e.parentNode;e.remove();var i=t();return n?o.insertBefore(i,n):o.appendChild(i),i},e.createElement=function(t,n){for(var o,a=[],l=2;l<arguments.length;l++)a[l-2]=arguments[l];var s=null,u="function"==typeof t;u&&t.name&&t.prototype instanceof e.ElementBase?s=new t(n).render():s=u?t(n):document.createElement(t);if(!(s instanceof HTMLElement))return console.error($(r||(r=i(["JSX Render must return a valid element: elem is not an instance of HTMLElement"],["JSX Render must return a valid element: elem is not an instance of HTMLElement"])))),console.table(((o={})['"type" argument']=t,o.Type=typeof s,o.Value=s,o)),console.trace(),null;if(a){var c=document.createDocumentFragment(),d=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t];if(o instanceof HTMLElement)c.appendChild(o);else if(Array.isArray(o))d(o);else if("number"==typeof o)c.appendChild(document.createTextNode(o.toString()));else if("string"==typeof o)c.appendChild(document.createTextNode(o));else if(null===o||void 0===o||"boolean"==typeof o)console.log("JSX got an unrenderable child value, assuming it's control flow related: type: "+typeof o+" value: "+o+".");else{var i=[];for(var r in o)i.push(o[r]);d(i)}}};d(a),s.appendChild(c)}var f=function(e){return e.startsWith("on")},g=function(e){return e.substring(2).toLowerCase()};for(var p in n){var h=n[p];if(f(p))s.addEventListener(g(p),h);else if("className"===p)if(h&&Array.isArray(h))for(var m=0,v=h;m<v.length;m++){var w=v[m];!w||w.length<=0||s.classList.add(w)}else"string"==typeof h&&h.length>0&&(s.className=s.className&&s.classList.length>0?s.className+" "+h:h);else if("style"===p)if("string"==typeof h)s.style.cssText=h;else if("object"==typeof h)for(var y in h)h&&(s.style[y]=h[y]);else void 0!==h&&console.error("Unknown style attribute type: "+typeof h+", "+h);else p.startsWith("data")?s.setAttribute(p,h):s[p]=h}return s};var t=function(){return function(){var t=this;this.elementRoot=null,this.render=function(){var e=t.internalRender();return t.setRoot(e),e},this.rerender=function(){return e.rerender(t.getRoot(),function(){return t.render()})},this.setRoot=function(e){return t.elementRoot=e},this.getRoot=function(){return t.elementRoot},this.dispose=function(){t.getRoot().remove()}}}();e.ElementBase=t}(o||(o={})),t.DOM=o;t.SidebarSeparator=function(e){var t=e&&e.big;return o.createElement("div",null,t&&o.createElement("div",{className:"clear",style:{height:t}}),o.createElement("hr",null),t&&o.createElement("div",{className:"clear",style:{height:t}}))};var r;t.SidebarCategoryTitle=function(e){return o.createElement("h3",{style:{marginBottom:"5px",marginLeft:"5px"}})}},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=(e=>{const t=e.replace(/\\/g,"/").split("/");if(t.length<=0)throw new Error("Invalid dirname given.");return t[t.length-1]+".js"})},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.R20Module=void 0;var o=function(e){return e&&e.__esModule?e:{default:e}}(n(3));function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}let a={};t.R20Module=a,a.Base=function(){function e(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"getAllHooks",e=>window.r20es.hooks),this.filename=(0,o.default)(e),this.isDisposed=!0}var t=e.prototype;return t.installFirstTime=function(){},t.installUpdate=function(){},t.dispose=function(){},t.internalCanInstall=function(){return!!this.getHook().config.enabled&&(!!this.isDisposed||(console.error("Attempted to install module when it's not disposed."),console.table({"Module filename":this.filename}),console.trace(),!1))},t.internalInstallFirstTime=function(){if(this.internalCanInstall()){try{this.installFirstTime()}catch(e){console.error(e)}this.isDisposed=!1}},t.internalInstallUpdate=function(){if(this.internalCanInstall()){try{this.installUpdate()}catch(e){console.error(e)}this.isDisposed=!1}},t.internalDispose=function(){if(console.log(this),this.isDisposed)return console.error("internalDispose called on module that is already disposed!"),console.table({"Module filename":this.filename}),void console.trace();try{this.dispose()}catch(e){console.error(e)}this.isDisposed=!0},t.setConfigValue=function(e,t){const n=this.getHook(),o=this.getHook().config;if(!(e in o))return void console.error(`Tried to set config of key ${e} to value ${t} but key was not found in the config of module id ${n.id}"`);const i=o[e];o[e]=t,n.saveConfig(),o.enabled&&"onSettingChange"in this&&"function"==typeof this.onSettingChange&&this.onSettingChange(e,i,t)},t.getHook=function(){if(!1 in window.r20es)return null;for(const e in window.r20es.hooks){const t=window.r20es.hooks[e];if(t.filename&&t.filename===this.filename)return t}return null},t.toggleEnabledState=function(e){const t=this.getHook(),n=void 0===e||null===e?!t.config.enabled:e;if(t.config.enabled&&n)return;const o=t.config.enabled;t.config.enabled=n,t.saveConfig(),o&&!n?(console.log("disabling"),this.internalDispose()):!o&&n&&(console.log("enabling"),this.internalInstallUpdate())},t.install=function(){if(!("r20esInstalledModuleTable"in window))return;if(!("r20esDisposeTable"in window))return;console.log(`Installing module filename: ${this.filename}`),!(this.filename in window.r20esInstalledModuleTable)?(console.log("First run"),this.internalInstallFirstTime()):(this.filename in window.r20esDisposeTable&&console.error(`DUPLICATE MODULE FOUND: ${this.filename}`),console.log("Calling install update"),this.internalInstallUpdate()),window.r20esDisposeTable[this.filename]=(()=>{this.dispose()}),window.r20esInstalledModuleTable[this.filename]=this,console.log(`DONE! module ID: ${this.filename}`)},e}(),a.SimpleBase=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.installFirstTime=function(){this.setup()},n.installUpdate=function(){this.setup()},n.setup=function(){},t}(a.Base),a.OnAppLoadBase=function(e){function t(t){var n;return(n=e.call(this,t)||this).setup=n.setup.bind(i(i(n))),n}r(t,e);var n=t.prototype;return n.installFirstTime=function(){window.r20es.isLoading?(this.earlySetup(),window.r20es.onAppLoad.addEventListener(this.setup)):(this.earlySetup(),this.setup())},n.earlySetup=function(){},n.setup=function(){},n.installUpdate=function(){this.installFirstTime()},n.dispose=function(){window.r20es.onAppLoad.removeEventListener(this.setup)},t}(a.Base),a.canInstall=(e=>window.r20es&&"canInstallModules"in window.r20es&&window.r20es.canInstallModules),a.getModule=function(e){return"r20esInstalledModuleTable"in window?window.r20esInstalledModuleTable[e]:null},a.getModuleById=function(e){return"r20esInstalledModuleTable"in window?a.getModule(window.r20es.hooks[e].filename):null}},5:function(e,t,n){"use strict";t.__esModule=!0;var o,i=n(7);!function(e){var t;function n(){return window.d20.engine.unselect()}function o(e){window.d20.engine.select(e)}function r(){return window.currentPlayer}function a(){return window.currentEditingLayer}function l(){try{var e=window.d20.Campaign.attributes.jukeboxfolder;return JSON.parse(e||"[]")}catch(e){console.error("[getJukeboxFileStructure] failed to get fs due to exception",e)}return[]}function s(e){return window.Jukebox.playlist.get(e)}function u(){return window.d20.Campaign.activePage()}function c(){return window.d20.engine.canvas.getObjects()}function d(t){for(var n=0,o=c();n<o.length;n++){var i=o[n],r=e.try_get_canvas_object_model(i);if(r&&r.get("id")===t)return i}return null}function f(e,t,n){n?($(document).on("mancerroll:"+t,function(e,o){$(document).off("mancerroll:"+t),n(e,o)}),window.d20.textchat.doChatInput(e,t)):window.d20.textchat.doChatInput(e)}function g(e){window.d20.textchat.incoming(!1,{who:"system",type:"system",content:e})}function p(){window.d20.engine.redrawScreenNextTick(!1)}!function(e){e[e.NumericAscending=0]="NumericAscending",e[e.NumericDescending=1]="NumericDescending",e[e.Alphabetical=2]="Alphabetical",e[e.AlphabeticalDescending=3]="AlphabeticalDescending",e[e.Card=4]="Card"}(t=e.InitiativeOrdering||(e.InitiativeOrdering={})),function(e){e.Map="map",e.PlayerTokens="objects",e.GMTokens="gmlayer",e.Lighting="walls",e.B20Foreground="foreground",e.B20Weather="weather"}(e.CanvasLayer||(e.CanvasLayer={})),e.setBackgroundStyle=function(e){window.d20.engine.backgroundColor=e},e.setupImageDropTarget=function(e,t,n){var o={model:{save:t},updateModel:n};window.d20.utils.setupAvatar(e,o)},e.getCanvasMousePos=function(){return window.d20.engine.mousePos.slice()},e.onInitiativeChange=function(t){return new i.EventSubscriber("change:turnorder",t,function(){return e.getInitiativeWindow().model})},e.setCanvasObjectLocation=function(t,n,o){var i=e.try_get_canvas_object_model(t);i&&i.save({top:o,left:n})},e.getBlob=function(e,t,n){return void 0===n&&(n=5e3),new Promise(function(o,i){e._getLatestBlob(t,o),setTimeout(i,n)})},e.getCampaign=function(){return window.Campaign},e.canEditCharacter=function(t){var n=t.attributes.controlledby;return!!e.isGM()||(!!n.includes("all")||!!n.includes(e.getCurrentPlayer().id))},e.getHandout=function(e){return window.Campaign.handouts.get(e)},e.createCharacter=function(e){return window.Campaign.characters.create(e)},e.setCanvasObjectDimensions=function(t,n,o){var i=e.try_get_canvas_object_model(t);i&&i.save({width:n,height:o})},e.getCharacter=function(e){return window.Campaign.characters.get(e)},e.getAllCharacters=function(){return window.Campaign.characters.models},e.getAllPages=function(){return window.Campaign.pages.models},e.createRollableTable=function(e){return window.d20.Campaign.rollabletables.create(e)},e.getRollableTable=function(e){return window.d20.Campaign.rollabletables.get(e)},e.getSelectedTokens=function(){return window.d20.engine.selected()},e.unselectTokens=n,e.addTokenToSelection=o,e.selectToken=function(e){n(),o(e)},e.hideTokenRadialMenu=function(){window.d20.token_editor.removeRadialMenu()},e.hideTokenContextMenu=function(){window.d20.token_editor.closeContextMenu()},e.getCurrentPlayer=r,e.getCanvasZoom=function(){return window.d20.engine.canvasZoom},e.getCanvasWidth=function(){return window.d20.engine.canvas.width},e.getCanvasHeight=function(){return window.d20.engine.canvas.height},e.getCanvasOffsetX=function(){return window.d20.engine.currentCanvasOffset[0]},e.getCanvasOffsetY=function(){return window.d20.engine.currentCanvasOffset[1]},e.getPageById=function(e){return window.Campaign.pages.get(e)},e.isGM=function(){return window.is_gm},e.getCurrentLayer=a,e.generateUUID=function(){return window.generateUUID()},e.getCurrentToolName=function(){return window.d20.engine.mode},e.advanceInitiative=function(){window.d20.Campaign.initiativewindow.nextTurn()},e.addTokenToInitiative=function(e){window.d20.Campaign.initiativewindow.addTokenToList(e)},e.addCustomItemToInitiative=function(e,t){window.d20.Campaign.initiativewindow.addTokenToList("-1",e,t)},e.rerenderMacroBar=function(){window.d20.player_settings.refreshMacroBar()},e.rerenderJournalMacros=function(){window.d20.player_settings.refreshRollsList()},e.orderInitiativeBy=function(e){var n,o=((n={})[t.NumericAscending]=".sortlist_numeric",n[t.NumericDescending]=".sortlist_numericdesc",n[t.Alphabetical]=".sortlist_alpha",n[t.AlphabeticalDescending]=".sortlist_alphadesc",n[t.Card]=".sortlist_card",n);if(e in o){var i=o[e];$("#initiativewindow_settings").dialog({modal:!1,title:"Turn Order Settings",beforeClose:function(){}}),$(i).click()}else console.error("Invalid initiative ordering: "+e)},e.getInitiativeWindow=function(){return window.d20.Campaign.initiativewindow},e.getJukeboxFileStructure=l,e.setJukeboxFileStructure=function(t){e.getCampaign().save({jukeboxfolder:JSON.stringify(t)})},e.createPlaylist=function(e){return window.d20.jukebox.addFolderToFolderStructure(e)},e.addTrackToPlaylist=function(e,t){return window.d20.jukebox.addItemToFolderStructure(e,t)},e.getSongById=s,e.getJukeboxPlaylists=function(){for(var e=[],t=0,n=l();t<n.length;t++){var o=n[t];if("string"!=typeof o){for(var i=o,r={id:i.id,name:i.n,mode:i.s,songs:[]},a=0,u=i.i;a<u.length;a++){var c=u[a],d=s(c);d?r.songs.push(d):console.warn("Tried to get song id "+c+" but the query returned a falsy value. Skipping")}e.push(r)}}return e},e.playAudio=function(e,t){window.Jukebox.soundObjs[e]=window.soundManager.createSound({id:e,url:t})},e.createSong=function(e){return window.Jukebox.playlist.create(e)},e.makePlaylistStructure=function(e,t,n){return{id:window.generateUUID(),n:e,s:t,i:n||[]}},e.getInitiativeData=function(){return window.d20.Campaign.initiativewindow.cleanList()},e.setInitiativeData=function(e){window.d20.Campaign.initiativewindow.model.save({turnorder:JSON.stringify(e)})},e.getCurrentPage=u,e.getCurrentPageTokens=c,e.doesTokenContainMouse=function(e,t){return window.d20.engine.canvas.containsPoint(e,t)},e.getCurrentPageTokenByUUID=d,e.try_get_canvas_object_model=function(e){return e._model?e._model:e.model?e.model:null},e.isUsing5EOGLSheet=function(){try{return window.d20.journal.customSheets.workerScripts[0].includes("5th Edition OGL by Roll20")}catch(e){return!1}},e.moveCameraToTokenByUUID=function(e){if(e){var t=d(e);if(t){var n=$("#editor-wrapper")[0];n.scrollTop=Math.floor(t.top*window.d20.engine.canvasZoom)-Math.floor(window.d20.engine.canvasHeight/2)+125*window.d20.engine.canvasZoom,n.scrollLeft=Math.floor(t.left*window.d20.engine.canvasZoom)-Math.floor(window.d20.engine.canvasWidth/2)+125*window.d20.engine.canvasZoom}}},e.primitiveSay=function(e,t){window.d20.textchat.doChatInput(e,t)},e.say=f,e.sayToSelf=function(t,n){var o='/w "'+r().get("displayname")+'" '+t;n?f(o,e.generateUUID(),n):f(o)},e.saySystemRaw=g,e.saySystem=function(e){g('<span style="background: rgba(6,26,45,255);\n    color: whitesmoke;\n    border: none;\n    display: inline-block;\n    padding: 8px;\n    margin: -15px -5px -7px -45px;    \n    "\n>\n'+e+"\n</span>\n        ")},e.ping=function(e,t,n,o,i){n=n||r().id,window.d20.engine.pings[n]={left:e,top:t,radius:-5,player:n,pageid:o||u().id,currentLayer:i||a()},window.d20.engine.pinging={downx:e,downy:t},p()},e.getFabric=function(){return window.exports.fabric},e.renderAll=p,e.setGMLayerOpacity=function(e){window.d20.engine.gm_layer_opacity=e},e.hasBetteR20=function(){return void 0!==window.d20plus},e.wipeObjectStorage=function(e){for(var t=e.length,n=0;n<t;n++){var o=e.length-1;if(0>o)break;var i=e.models[o];if(!i||void 0===i)break;i.destroy()}e.length<0&&console.error("FAILED TO WIPE OBJECT STORAGE!")},e.doBulkRoll=function(t,n,o,i,r){e.unselectTokens();var a=function(t){if(e.selectToken(t),r){var o=r(t);o&&e.say(n,o.id,o.callback)}else e.say(n)},l=function(){if(e.hideTokenRadialMenu(),e.hideTokenContextMenu(),i)for(var n=0,o=t;n<o.length;n++){var r=o[n];e.addTokenToSelection(r)}};if(0===o){for(var s=0,u=t;s<u.length;s++){var c=u[s];a(c)}l()}else for(var d=o,f=function(e){setTimeout(function(){a(t[e]),e+1===t.length&&l()},d),d+=o},g=0;g<t.length;g++)f(g)}}(o||(o={})),t.R20=o},6:function(e,t,n){"use strict";t.__esModule=!0;var o=n(8);t.copy=function(e,t){var n=Object.assign({},e);return t&&(n=Object.assign(n,t)),n};var i=function(e){if("currentTransform"in e)return e.currentTransform;if("getTransform"in e)return e.getTransform();if(e.mozCurrentTransform){var t=e.mozCurrentTransform;return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}};t.getTransform=i;t.getRotation=function(e){var t=i(e),n=Math.atan2(t.b,t.a);return n<0&&(n+=2*Math.PI),n};t.findByIdAndRemove=function(e){var t=document.getElementById(e);t&&t.remove()};t.mapObj=function(e,t){return Object.keys(e).reduce(function(n,o){var i=t(e[o],o);return void 0!==i&&null!==i&&n.push(i),n},[])};t.safeCall=function(e){try{e()}catch(e){console.error(e)}};t.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)};t.replaceAll=function(e,t,n){return e.replace(new RegExp(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(t),"g"),n)};t.safeParseJson=function(e){try{return JSON.parse(e)}catch(e){alert("File is not a valid JSON file.")}return null};t.readFile=function(e){return new Promise(function(t,n){if(e){var o=new FileReader;o.readAsText(e),o.onload=function(e){t(e.target.result)}}else n("No file given.")})};var r=function(){return chrome||browser};t.getBrowser=r;t.injectScript=function(e){console.log("Injecting "+e);var t=document.createElement("script");t.async=!1,t.src=r().extension.getURL(e),t.onload=function(){t.remove()},document.head.appendChild(t)};t.strIsNullOrEmpty=function(e){return null===e||void 0===e||e.length<=0||e.trim().length<=0};t.createCSSElement=function(e,t){var n=document.createElement("style");return n.innerHTML=e,n.id=t,n};t.getExtUrlFromPage=function(e,t){var n=void 0===t||null===t?1e3:t;return new Promise(function(t,i){try{var r=!1,a=function(){window.removeEventListener("message",s)},l=window.generateUUID(),s=function(e){e.origin===o.Config.appUrl&&e.data.r20esGivesResourceUrl&&e.data.r20esGivesResourceUrl.id===l&&(r=!0,a(),t(e.data.r20esGivesResourceUrl.url))};window.addEventListener("message",s);var u={resource:e,id:l};window.postMessage({r20esWantsResourceUrl:u},o.Config.appUrl),setTimeout(function(){try{r||(a(),i("Timed out after "+n+"ms"))}catch(e){i(e)}},n)}catch(e){i(e)}})}},7:function(e,t,n){"use strict";t.__esModule=!0;var o=function(){function e(e,t,n){this._isSubscribed=!1,this._name=e,this._callback=t,this._targetGetter=n}return e.subscribe=function(t,n,o){var i=new e(t,n,o);return i.subscribe(),i},e.prototype.subscribe=function(){if(!this._isSubscribed){var e=this._targetGetter();"on"in e?e.on(this._name,this._callback):e.addEventListener(this._name,this._callback),this._isSubscribed=!0}},e.prototype.unsubscribe=function(){if(this._isSubscribed){var e=this._targetGetter();"off"in e?e.off(this._name,this._callback):e.removeEventListener(this._name,this._callback),this._isSubscribed=!1}},e}();t.EventSubscriber=o},8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;let o={};t.Config=o,o.appUrl="https://app.roll20.net",o.websiteFeatureUrlTemplate="https://ssstormy.github.io/roll20-enhancement-suite/features#",o.website="https://ssstormy.github.io/roll20-enhancement-suite/",o.discordInvite="https://discord.gg/pKxxvuM",o.contributeUrl="https://ssstormy.github.io/roll20-enhancement-suite/contribute.html"},85:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&(n[o[i]]=e[o[i]])}return n};t.__esModule=!0;var r=n(2);t.SettingsSidebarButton=function(e){var t=e.text,n=i(e,["text"]);return r.DOM.createElement("input",o({type:"button",style:{marginBottom:"8px",width:"calc(100% - 21px)"},className:"btn",value:t},n))}},86:function(e,t,n){"use strict";t.__esModule=!0,t.insertButtonIntoSettings=function(e){var t=document.getElementById("exitroll20game");t.parentNode.parentNode.insertBefore(e,t.parentNode)}}});